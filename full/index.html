<!DOCTYPE html><html><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Automatically Assigning A Section Hierarchy For Dutch Case Law</title><meta name="description"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="apple-touch-icon" href="apple-touch-icon.png"/><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Sans"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.6.0/katex.min.css"/><link rel="stylesheet" href="../style.css"/></head><body class="p2"><div><section id="title-page"><div id="title-page-university-name">Utrecht University</div><div id="title-page-faculty-name">Faculty of Humanities</div><div id="title-page-msc-thesis">Master of Science Thesis</div><h1>Automatically Assigning A Section Hierarchy For Dutch Case Law</h1><div id="title-page-author"><div id="title-page-author-author">by</div><div id="title-page-author-name">Maarten Trompper</div></div><div id="title-page-supervisor"><div id="title-page-supervisor-supervisor">Supervisor:</div><div id="title-page-supervisor-name">Ad Feelders</div></div><div id="title-page-time-and-date"><span id="title-page-time">Utrecht</span>, <span id="title-page-date">2016</span></div></section><section id="#toc"><h2>Table of Contents</h2><nav class="chapter toc"><ol><li><a href="#chapter-introduction" class="nav-link">Introduction</a><ol><li><a href="#motivation">Motivation</a></li><li><a href="#problem-description">Problem Description</a></li></ol></li><li><a href="#chapter-importing-and-tokenizing" class="nav-link">Importing &amp; Tokenizing Data</a><ol><li><a href="#rechtspraak-nl-data-set">Rechtspraak.nl Data Set</a></li><li><a href="#importing">Importing &amp; Tokenizing Data</a></li></ol></li><li><a href="#tagging" class="nav-link">Tagging Elements</a><ol><li><a href="#tagging-introduction">Introduction</a></li><li><a href="#tagging-methods">Methods</a><ol><li><a href="#feature-selection">Feature Selection</a></li><li><a href="#crf">Conditional Random Fields</a><ol><li><a href="#graphical-models">Graphical Models</a></li><li><a href="#hmm">Hidden Markov Models</a></li><li><a href="#linear-chain-crf">Linear Chain Conditional Random Fields</a></li><li><a href="#crf-parameter-estimation">Parameter Estimation</a></li><li><a href="#crf-inference">Inference</a></li></ol></li></ol></li><li><a href="#tagging-evaluation">Evaluation</a><ol><li><a href="#f-scores">F-scores</a></li><li><a href="#tagging-results">Results</a></li></ol></li></ol></li><li><a href="#parsing" class="nav-link">Inferring a Section Hierarchy</a><ol><li><a href="#parse-tree-introduction">Introduction</a></li><li><a href="#parse-tree-methods">Methods</a><ol><li><a href="#scfg">Stochastic Context Free Grammars</a></li><li><a href="#cyk">CYK Algorithm</a></li></ol></li><li><a href="#parse-tree-evaluation">Evaluation</a><ol><li><a href="#parseval">PARSEVAL</a></li><li><a href="#parsing-results">Results &amp; Discussion</a></li></ol></li></ol></li><li><a href="#conclusion" class="nav-link">Conclusion</a><ol></ol></li></ol></nav></section><div><section class="chapter"><h2 class="title"><a class="link-up" href="#"></a>Introduction</h2><p>In this thesis, we explore the problem of automatically assigning a section hierarchy to sparsely marked up documents in the Dutch case law repository of <a href="http://www.rechtspraak.nl/">Rechtspraak.nl</a>.</p><p><strike>Near the end of this chapter, we present a Java library that bundles all the work that we have undertaken in this thesis. This library is effectively a pipeline for enriching Dutch case law markup with a section hierarchy.</strike></p><section id="motivation"><h3 class="title"><a class="link-up" href="#"></a>Motivation</h3><div><p>Having a section hierarchy in case law documents is obviously useful for rendering the documents to human users: it allows us to display a table of contents and to style section titles. It also allows search engines to better index the subsections of a text to make it better searchable for legal users, and is a stepping stone to more advanced text mining operations, such as singling out the final judgment, perform information extraction, etc.</p><p>There is a recent trend among the court judgments on Rechtspraak.nl towards more richly marked up documents, as we can see in <a href="#markup-stats">Figure 1</a>. However, an overwhelmingly large portion of documents remains which contain no or only sparse markup. To illustrate: at the time of writing, 78.7% of all judgment texts on Rechtspraak.nl do not contain any <code>section</code> tag, implying that a large amount of documents are barely marked up. Even older documents produce legal knowledge, so it is desirable to have these documents in good shape.</p><figure id="markup-stats"><div class="figure-container"><svg class="chart" width="600" height="300"><g transform="translate(50,35)"><g class="axis"><g class="x axis" transform="translate(0,235)"><g style="opacity:1;" class="tick" transform="translate(25,0)"><line y2="6" x2="0"></line><text style="text-anchor:middle;" dy=".71em" y="9" x="0"></text></g><g style="opacity:1;" class="tick" transform="translate(38,0)"><line y2="6" x2="0"></line><text style="text-anchor:middle;" dy=".71em" y="9" x="0">1976</text></g><g style="opacity:1;" class="tick" transform="translate(51,0)"><line y2="6" x2="0"></line><text style="text-anchor:middle;" dy=".71em" y="9" x="0"></text></g><g style="opacity:1;" class="tick" transform="translate(64,0)"><line y2="6" x2="0"></line><text style="text-anchor:middle;" dy=".71em" y="9" x="0"></text></g><g style="opacity:1;" class="tick" transform="translate(77,0)"><line y2="6" x2="0"></line><text style="text-anchor:middle;" dy=".71em" y="9" x="0">1982</text></g><g style="opacity:1;" class="tick" transform="translate(90,0)"><line y2="6" x2="0"></line><text style="text-anchor:middle;" dy=".71em" y="9" x="0"></text></g><g style="opacity:1;" class="tick" transform="translate(103,0)"><line y2="6" x2="0"></line><text style="text-anchor:middle;" dy=".71em" y="9" x="0"></text></g><g style="opacity:1;" class="tick" transform="translate(116,0)"><line y2="6" x2="0"></line><text style="text-anchor:middle;" dy=".71em" y="9" x="0">1985</text></g><g style="opacity:1;" class="tick" transform="translate(129,0)"><line y2="6" x2="0"></line><text style="text-anchor:middle;" dy=".71em" y="9" x="0"></text></g><g style="opacity:1;" class="tick" transform="translate(142,0)"><line y2="6" x2="0"></line><text style="text-anchor:middle;" dy=".71em" y="9" x="0"></text></g><g style="opacity:1;" class="tick" transform="translate(155,0)"><line y2="6" x2="0"></line><text style="text-anchor:middle;" dy=".71em" y="9" x="0">1988</text></g><g style="opacity:1;" class="tick" transform="translate(168,0)"><line y2="6" x2="0"></line><text style="text-anchor:middle;" dy=".71em" y="9" x="0"></text></g><g style="opacity:1;" class="tick" transform="translate(181,0)"><line y2="6" x2="0"></line><text style="text-anchor:middle;" dy=".71em" y="9" x="0"></text></g><g style="opacity:1;" class="tick" transform="translate(194,0)"><line y2="6" x2="0"></line><text style="text-anchor:middle;" dy=".71em" y="9" x="0">1991</text></g><g style="opacity:1;" class="tick" transform="translate(207,0)"><line y2="6" x2="0"></line><text style="text-anchor:middle;" dy=".71em" y="9" x="0"></text></g><g style="opacity:1;" class="tick" transform="translate(220,0)"><line y2="6" x2="0"></line><text style="text-anchor:middle;" dy=".71em" y="9" x="0"></text></g><g style="opacity:1;" class="tick" transform="translate(233,0)"><line y2="6" x2="0"></line><text style="text-anchor:middle;" dy=".71em" y="9" x="0">1994</text></g><g style="opacity:1;" class="tick" transform="translate(246,0)"><line y2="6" x2="0"></line><text style="text-anchor:middle;" dy=".71em" y="9" x="0"></text></g><g style="opacity:1;" class="tick" transform="translate(259,0)"><line y2="6" x2="0"></line><text style="text-anchor:middle;" dy=".71em" y="9" x="0"></text></g><g style="opacity:1;" class="tick" transform="translate(272,0)"><line y2="6" x2="0"></line><text style="text-anchor:middle;" dy=".71em" y="9" x="0">1997</text></g><g style="opacity:1;" class="tick" transform="translate(285,0)"><line y2="6" x2="0"></line><text style="text-anchor:middle;" dy=".71em" y="9" x="0"></text></g><g style="opacity:1;" class="tick" transform="translate(298,0)"><line y2="6" x2="0"></line><text style="text-anchor:middle;" dy=".71em" y="9" x="0"></text></g><g style="opacity:1;" class="tick" transform="translate(311,0)"><line y2="6" x2="0"></line><text style="text-anchor:middle;" dy=".71em" y="9" x="0">2000</text></g><g style="opacity:1;" class="tick" transform="translate(324,0)"><line y2="6" x2="0"></line><text style="text-anchor:middle;" dy=".71em" y="9" x="0"></text></g><g style="opacity:1;" class="tick" transform="translate(337,0)"><line y2="6" x2="0"></line><text style="text-anchor:middle;" dy=".71em" y="9" x="0"></text></g><g style="opacity:1;" class="tick" transform="translate(350,0)"><line y2="6" x2="0"></line><text style="text-anchor:middle;" dy=".71em" y="9" x="0">2003</text></g><g style="opacity:1;" class="tick" transform="translate(363,0)"><line y2="6" x2="0"></line><text style="text-anchor:middle;" dy=".71em" y="9" x="0"></text></g><g style="opacity:1;" class="tick" transform="translate(376,0)"><line y2="6" x2="0"></line><text style="text-anchor:middle;" dy=".71em" y="9" x="0"></text></g><g style="opacity:1;" class="tick" transform="translate(389,0)"><line y2="6" x2="0"></line><text style="text-anchor:middle;" dy=".71em" y="9" x="0">2006</text></g><g style="opacity:1;" class="tick" transform="translate(402,0)"><line y2="6" x2="0"></line><text style="text-anchor:middle;" dy=".71em" y="9" x="0"></text></g><g style="opacity:1;" class="tick" transform="translate(415,0)"><line y2="6" x2="0"></line><text style="text-anchor:middle;" dy=".71em" y="9" x="0"></text></g><g style="opacity:1;" class="tick" transform="translate(428,0)"><line y2="6" x2="0"></line><text style="text-anchor:middle;" dy=".71em" y="9" x="0">2009</text></g><g style="opacity:1;" class="tick" transform="translate(441,0)"><line y2="6" x2="0"></line><text style="text-anchor:middle;" dy=".71em" y="9" x="0"></text></g><g style="opacity:1;" class="tick" transform="translate(454,0)"><line y2="6" x2="0"></line><text style="text-anchor:middle;" dy=".71em" y="9" x="0"></text></g><g style="opacity:1;" class="tick" transform="translate(467,0)"><line y2="6" x2="0"></line><text style="text-anchor:middle;" dy=".71em" y="9" x="0">2012</text></g><g style="opacity:1;" class="tick" transform="translate(480,0)"><line y2="6" x2="0"></line><text style="text-anchor:middle;" dy=".71em" y="9" x="0"></text></g><g style="opacity:1;" class="tick" transform="translate(493,0)"><line y2="6" x2="0"></line><text style="text-anchor:middle;" dy=".71em" y="9" x="0"></text></g><g style="opacity:1;" class="tick" transform="translate(506,0)"><line y2="6" x2="0"></line><text style="text-anchor:middle;" dy=".71em" y="9" x="0">2015</text></g><path class="domain" d="M0,6V0H530V6"></path></g></g><g class="axis"><g class="y axis"><g style="opacity:1;" class="tick" transform="translate(0,235)"><line x2="-6" y2="0"></line><text style="text-anchor:end;" dy=".32em" x="-9" y="0">0</text></g><g style="opacity:1;" class="tick" transform="translate(0,198.70768470471955)"><line x2="-6" y2="0"></line><text style="text-anchor:end;" dy=".32em" x="-9" y="0">5,000</text></g><g style="opacity:1;" class="tick" transform="translate(0,162.4153694094391)"><line x2="-6" y2="0"></line><text style="text-anchor:end;" dy=".32em" x="-9" y="0">10,000</text></g><g style="opacity:1;" class="tick" transform="translate(0,126.12305411415863)"><line x2="-6" y2="0"></line><text style="text-anchor:end;" dy=".32em" x="-9" y="0">15,000</text></g><g style="opacity:1;" class="tick" transform="translate(0,89.83073881887817)"><line x2="-6" y2="0"></line><text style="text-anchor:end;" dy=".32em" x="-9" y="0">20,000</text></g><g style="opacity:1;" class="tick" transform="translate(0,53.53842352359773)"><line x2="-6" y2="0"></line><text style="text-anchor:end;" dy=".32em" x="-9" y="0">25,000</text></g><g style="opacity:1;" class="tick" transform="translate(0,17.246108228317272)"><line x2="-6" y2="0"></line><text style="text-anchor:end;" dy=".32em" x="-9" y="0">30,000</text></g><path class="domain" d="M-6,0H0V235H-6"></path><text style="text-anchor:end;" transform="rotate(-90)" y="6" dy=".71em">Document count</text></g></g><g><g><line class="horizontalGrid" x1="20" x2="530" y1="235" y2="235" fill="none" stroke="lightgray" stroke-width="1px"></line><line class="horizontalGrid" x1="20" x2="530" y1="198.70768470471955" y2="198.70768470471955" fill="none" stroke="lightgray" stroke-width="1px"></line><line class="horizontalGrid" x1="20" x2="530" y1="162.4153694094391" y2="162.4153694094391" fill="none" stroke="lightgray" stroke-width="1px"></line><line class="horizontalGrid" x1="20" x2="530" y1="126.12305411415863" y2="126.12305411415863" fill="none" stroke="lightgray" stroke-width="1px"></line><line class="horizontalGrid" x1="20" x2="530" y1="89.83073881887817" y2="89.83073881887817" fill="none" stroke="lightgray" stroke-width="1px"></line><line class="horizontalGrid" x1="20" x2="530" y1="53.53842352359773" y2="53.53842352359773" fill="none" stroke="lightgray" stroke-width="1px"></line><line class="horizontalGrid" x1="20" x2="530" y1="17.246108228317272" y2="17.246108228317272" fill="none" stroke="lightgray" stroke-width="1px"></line></g></g><g class="legend"><rect width="115" x="20" height="82" fill="#FFFFFF"></rect><g class="label series-1"><rect x="25" y="5" fill="#1E405C" width="25" height="15" class="series-1"></rect><text fill="#000" x="55" y="15">Contains &lt;*.info&gt; tag and &lt;section&gt; tag</text></g><g class="label series-2"><rect x="25" y="24" fill="#2C70A9" width="25" height="15" class="series-2"></rect><text fill="#000" x="55" y="34">Contains only &lt;section&gt; tag</text></g><g class="label series-3"><rect x="25" y="43" fill="#56a0dd" width="25" height="15" class="series-3"></rect><text fill="#000" x="55" y="53">Contains &lt;*.info&gt; tag</text></g><g class="label series-4"><rect x="25" y="62" fill="#9DCBF1" width="25" height="15" class="series-4"></rect><text fill="#000" x="55" y="72">Contains neither &lt;*.info&gt; tag nor &lt;section&gt; tag</text></g></g><g><g class="bar-group"><rect class="bar series-1" x="19" y="234.99274153694094" fill="#1E405C" width="12" height="0.00725846305905975" data-x="1970" data-y="1"><title>Contains &lt;*.info&gt; tag and &lt;section&gt; tag, 1970 (1)</title></rect><rect class="bar series-2" x="32" y="235" fill="#1E405C" width="12" height="0" data-x="1976" data-y="0"><title>Contains &lt;*.info&gt; tag and &lt;section&gt; tag, 1976 (0)</title></rect><rect class="bar series-3" x="45" y="235" fill="#1E405C" width="12" height="0" data-x="1977" data-y="0"><title>Contains &lt;*.info&gt; tag and &lt;section&gt; tag, 1977 (0)</title></rect><rect class="bar series-4" x="58" y="235" fill="#1E405C" width="12" height="0" data-x="1979" data-y="0"><title>Contains &lt;*.info&gt; tag and &lt;section&gt; tag, 1979 (0)</title></rect><rect class="bar series-5" x="71" y="235" fill="#1E405C" width="12" height="0" data-x="1982" data-y="0"><title>Contains &lt;*.info&gt; tag and &lt;section&gt; tag, 1982 (0)</title></rect><rect class="bar series-6" x="84" y="235" fill="#1E405C" width="12" height="0" data-x="1983" data-y="0"><title>Contains &lt;*.info&gt; tag and &lt;section&gt; tag, 1983 (0)</title></rect><rect class="bar series-7" x="97" y="235" fill="#1E405C" width="12" height="0" data-x="1984" data-y="0"><title>Contains &lt;*.info&gt; tag and &lt;section&gt; tag, 1984 (0)</title></rect><rect class="bar series-8" x="110" y="235" fill="#1E405C" width="12" height="0" data-x="1985" data-y="0"><title>Contains &lt;*.info&gt; tag and &lt;section&gt; tag, 1985 (0)</title></rect><rect class="bar series-9" x="123" y="235" fill="#1E405C" width="12" height="0" data-x="1986" data-y="0"><title>Contains &lt;*.info&gt; tag and &lt;section&gt; tag, 1986 (0)</title></rect><rect class="bar series-10" x="136" y="235" fill="#1E405C" width="12" height="0" data-x="1987" data-y="0"><title>Contains &lt;*.info&gt; tag and &lt;section&gt; tag, 1987 (0)</title></rect><rect class="bar series-11" x="149" y="235" fill="#1E405C" width="12" height="0" data-x="1988" data-y="0"><title>Contains &lt;*.info&gt; tag and &lt;section&gt; tag, 1988 (0)</title></rect><rect class="bar series-12" x="162" y="235" fill="#1E405C" width="12" height="0" data-x="1989" data-y="0"><title>Contains &lt;*.info&gt; tag and &lt;section&gt; tag, 1989 (0)</title></rect><rect class="bar series-13" x="175" y="235" fill="#1E405C" width="12" height="0" data-x="1990" data-y="0"><title>Contains &lt;*.info&gt; tag and &lt;section&gt; tag, 1990 (0)</title></rect><rect class="bar series-14" x="188" y="234.99274153694094" fill="#1E405C" width="12" height="0.00725846305905975" data-x="1991" data-y="1"><title>Contains &lt;*.info&gt; tag and &lt;section&gt; tag, 1991 (1)</title></rect><rect class="bar series-15" x="201" y="235" fill="#1E405C" width="12" height="0" data-x="1992" data-y="0"><title>Contains &lt;*.info&gt; tag and &lt;section&gt; tag, 1992 (0)</title></rect><rect class="bar series-16" x="214" y="235" fill="#1E405C" width="12" height="0" data-x="1993" data-y="0"><title>Contains &lt;*.info&gt; tag and &lt;section&gt; tag, 1993 (0)</title></rect><rect class="bar series-17" x="227" y="235" fill="#1E405C" width="12" height="0" data-x="1994" data-y="0"><title>Contains &lt;*.info&gt; tag and &lt;section&gt; tag, 1994 (0)</title></rect><rect class="bar series-18" x="240" y="235" fill="#1E405C" width="12" height="0" data-x="1995" data-y="0"><title>Contains &lt;*.info&gt; tag and &lt;section&gt; tag, 1995 (0)</title></rect><rect class="bar series-19" x="253" y="235" fill="#1E405C" width="12" height="0" data-x="1996" data-y="0"><title>Contains &lt;*.info&gt; tag and &lt;section&gt; tag, 1996 (0)</title></rect><rect class="bar series-20" x="266" y="234.98548307388188" fill="#1E405C" width="12" height="0.0145169261181195" data-x="1997" data-y="2"><title>Contains &lt;*.info&gt; tag and &lt;section&gt; tag, 1997 (2)</title></rect><rect class="bar series-21" x="279" y="235" fill="#1E405C" width="12" height="0" data-x="1998" data-y="0"><title>Contains &lt;*.info&gt; tag and &lt;section&gt; tag, 1998 (0)</title></rect><rect class="bar series-22" x="292" y="235" fill="#1E405C" width="12" height="0" data-x="1999" data-y="0"><title>Contains &lt;*.info&gt; tag and &lt;section&gt; tag, 1999 (0)</title></rect><rect class="bar series-23" x="305" y="234.97822461082282" fill="#1E405C" width="12" height="0.02177538917717925" data-x="2000" data-y="3"><title>Contains &lt;*.info&gt; tag and &lt;section&gt; tag, 2000 (3)</title></rect><rect class="bar series-24" x="318" y="234.9709661477638" fill="#1E405C" width="12" height="0.029033852236210578" data-x="2001" data-y="4"><title>Contains &lt;*.info&gt; tag and &lt;section&gt; tag, 2001 (4)</title></rect><rect class="bar series-25" x="331" y="234.95644922164567" fill="#1E405C" width="12" height="0.04355077835433008" data-x="2002" data-y="6"><title>Contains &lt;*.info&gt; tag and &lt;section&gt; tag, 2002 (6)</title></rect><rect class="bar series-26" x="344" y="234.96370768470473" fill="#1E405C" width="12" height="0.03629231529527033" data-x="2003" data-y="5"><title>Contains &lt;*.info&gt; tag and &lt;section&gt; tag, 2003 (5)</title></rect><rect class="bar series-27" x="357" y="234.97822461082282" fill="#1E405C" width="12" height="0.02177538917717925" data-x="2004" data-y="3"><title>Contains &lt;*.info&gt; tag and &lt;section&gt; tag, 2004 (3)</title></rect><rect class="bar series-28" x="370" y="234.9709661477638" fill="#1E405C" width="12" height="0.029033852236210578" data-x="2005" data-y="4"><title>Contains &lt;*.info&gt; tag and &lt;section&gt; tag, 2005 (4)</title></rect><rect class="bar series-29" x="383" y="234.96370768470473" fill="#1E405C" width="12" height="0.03629231529527033" data-x="2006" data-y="5"><title>Contains &lt;*.info&gt; tag and &lt;section&gt; tag, 2006 (5)</title></rect><rect class="bar series-30" x="396" y="234.89112305411416" fill="#1E405C" width="12" height="0.1088769458858394" data-x="2007" data-y="15"><title>Contains &lt;*.info&gt; tag and &lt;section&gt; tag, 2007 (15)</title></rect><rect class="bar series-31" x="409" y="234.86208920187795" fill="#1E405C" width="12" height="0.13791079812204998" data-x="2008" data-y="19"><title>Contains &lt;*.info&gt; tag and &lt;section&gt; tag, 2008 (19)</title></rect><rect class="bar series-32" x="422" y="234.69514455151963" fill="#1E405C" width="12" height="0.3048554484803674" data-x="2009" data-y="42"><title>Contains &lt;*.info&gt; tag and &lt;section&gt; tag, 2009 (42)</title></rect><rect class="bar series-33" x="435" y="234.59352606869285" fill="#1E405C" width="12" height="0.40647393130714704" data-x="2010" data-y="56"><title>Contains &lt;*.info&gt; tag and &lt;section&gt; tag, 2010 (56)</title></rect><rect class="bar series-34" x="448" y="234.25963676797627" fill="#1E405C" width="12" height="0.740363232023725" data-x="2011" data-y="102"><title>Contains &lt;*.info&gt; tag and &lt;section&gt; tag, 2011 (102)</title></rect><rect class="bar series-35" x="461" y="231.97322090437362" fill="#1E405C" width="12" height="3.026779095626381" data-x="2012" data-y="417"><title>Contains &lt;*.info&gt; tag and &lt;section&gt; tag, 2012 (417)</title></rect><rect class="bar series-36" x="474" y="161.23949839387203" fill="#1E405C" width="12" height="73.76050160612797" data-x="2013" data-y="10162"><title>Contains &lt;*.info&gt; tag and &lt;section&gt; tag, 2013 (10162)</title></rect><rect class="bar series-37" x="487" y="108.99308129478626" fill="#1E405C" width="12" height="126.00691870521374" data-x="2014" data-y="17360"><title>Contains &lt;*.info&gt; tag and &lt;section&gt; tag, 2014 (17360)</title></rect><rect class="bar series-38" x="500" y="125.68754633061526" fill="#1E405C" width="12" height="109.31245366938474" data-x="2015" data-y="15060"><title>Contains &lt;*.info&gt; tag and &lt;section&gt; tag, 2015 (15060)</title></rect></g><g class="bar-group"><rect class="bar series-1" x="19" y="234.99274153694094" fill="#2C70A9" width="12" height="0" data-x="1970" data-y="0"><title>Contains only &lt;section&gt; tag, 1970 (0)</title></rect><rect class="bar series-2" x="32" y="235" fill="#2C70A9" width="12" height="0" data-x="1976" data-y="0"><title>Contains only &lt;section&gt; tag, 1976 (0)</title></rect><rect class="bar series-3" x="45" y="235" fill="#2C70A9" width="12" height="0" data-x="1977" data-y="0"><title>Contains only &lt;section&gt; tag, 1977 (0)</title></rect><rect class="bar series-4" x="58" y="235" fill="#2C70A9" width="12" height="0" data-x="1979" data-y="0"><title>Contains only &lt;section&gt; tag, 1979 (0)</title></rect><rect class="bar series-5" x="71" y="235" fill="#2C70A9" width="12" height="0" data-x="1982" data-y="0"><title>Contains only &lt;section&gt; tag, 1982 (0)</title></rect><rect class="bar series-6" x="84" y="235" fill="#2C70A9" width="12" height="0" data-x="1983" data-y="0"><title>Contains only &lt;section&gt; tag, 1983 (0)</title></rect><rect class="bar series-7" x="97" y="235" fill="#2C70A9" width="12" height="0" data-x="1984" data-y="0"><title>Contains only &lt;section&gt; tag, 1984 (0)</title></rect><rect class="bar series-8" x="110" y="235" fill="#2C70A9" width="12" height="0" data-x="1985" data-y="0"><title>Contains only &lt;section&gt; tag, 1985 (0)</title></rect><rect class="bar series-9" x="123" y="235" fill="#2C70A9" width="12" height="0" data-x="1986" data-y="0"><title>Contains only &lt;section&gt; tag, 1986 (0)</title></rect><rect class="bar series-10" x="136" y="235" fill="#2C70A9" width="12" height="0" data-x="1987" data-y="0"><title>Contains only &lt;section&gt; tag, 1987 (0)</title></rect><rect class="bar series-11" x="149" y="235" fill="#2C70A9" width="12" height="0" data-x="1988" data-y="0"><title>Contains only &lt;section&gt; tag, 1988 (0)</title></rect><rect class="bar series-12" x="162" y="234.99274153694094" fill="#2C70A9" width="12" height="0.00725846305905975" data-x="1989" data-y="1"><title>Contains only &lt;section&gt; tag, 1989 (1)</title></rect><rect class="bar series-13" x="175" y="234.99274153694094" fill="#2C70A9" width="12" height="0.00725846305905975" data-x="1990" data-y="1"><title>Contains only &lt;section&gt; tag, 1990 (1)</title></rect><rect class="bar series-14" x="188" y="234.99274153694094" fill="#2C70A9" width="12" height="0" data-x="1991" data-y="0"><title>Contains only &lt;section&gt; tag, 1991 (0)</title></rect><rect class="bar series-15" x="201" y="235" fill="#2C70A9" width="12" height="0" data-x="1992" data-y="0"><title>Contains only &lt;section&gt; tag, 1992 (0)</title></rect><rect class="bar series-16" x="214" y="235" fill="#2C70A9" width="12" height="0" data-x="1993" data-y="0"><title>Contains only &lt;section&gt; tag, 1993 (0)</title></rect><rect class="bar series-17" x="227" y="235" fill="#2C70A9" width="12" height="0" data-x="1994" data-y="0"><title>Contains only &lt;section&gt; tag, 1994 (0)</title></rect><rect class="bar series-18" x="240" y="234.99274153694094" fill="#2C70A9" width="12" height="0.00725846305905975" data-x="1995" data-y="1"><title>Contains only &lt;section&gt; tag, 1995 (1)</title></rect><rect class="bar series-19" x="253" y="235" fill="#2C70A9" width="12" height="0" data-x="1996" data-y="0"><title>Contains only &lt;section&gt; tag, 1996 (0)</title></rect><rect class="bar series-20" x="266" y="234.98548307388188" fill="#2C70A9" width="12" height="0" data-x="1997" data-y="0"><title>Contains only &lt;section&gt; tag, 1997 (0)</title></rect><rect class="bar series-21" x="279" y="235" fill="#2C70A9" width="12" height="0" data-x="1998" data-y="0"><title>Contains only &lt;section&gt; tag, 1998 (0)</title></rect><rect class="bar series-22" x="292" y="234.99274153694094" fill="#2C70A9" width="12" height="0.00725846305905975" data-x="1999" data-y="1"><title>Contains only &lt;section&gt; tag, 1999 (1)</title></rect><rect class="bar series-23" x="305" y="234.94193229552755" fill="#2C70A9" width="12" height="0.03629231529527033" data-x="2000" data-y="5"><title>Contains only &lt;section&gt; tag, 2000 (5)</title></rect><rect class="bar series-24" x="318" y="234.9709661477638" fill="#2C70A9" width="12" height="0" data-x="2001" data-y="0"><title>Contains only &lt;section&gt; tag, 2001 (0)</title></rect><rect class="bar series-25" x="331" y="234.94193229552755" fill="#2C70A9" width="12" height="0.0145169261181195" data-x="2002" data-y="2"><title>Contains only &lt;section&gt; tag, 2002 (2)</title></rect><rect class="bar series-26" x="344" y="234.94193229552755" fill="#2C70A9" width="12" height="0.02177538917717925" data-x="2003" data-y="3"><title>Contains only &lt;section&gt; tag, 2003 (3)</title></rect><rect class="bar series-27" x="357" y="234.9491907585866" fill="#2C70A9" width="12" height="0.029033852236210578" data-x="2004" data-y="4"><title>Contains only &lt;section&gt; tag, 2004 (4)</title></rect><rect class="bar series-28" x="370" y="234.96370768470473" fill="#2C70A9" width="12" height="0.00725846305905975" data-x="2005" data-y="1"><title>Contains only &lt;section&gt; tag, 2005 (1)</title></rect><rect class="bar series-29" x="383" y="234.9491907585866" fill="#2C70A9" width="12" height="0.0145169261181195" data-x="2006" data-y="2"><title>Contains only &lt;section&gt; tag, 2006 (2)</title></rect><rect class="bar series-30" x="396" y="234.86208920187795" fill="#2C70A9" width="12" height="0.029033852236210578" data-x="2007" data-y="4"><title>Contains only &lt;section&gt; tag, 2007 (4)</title></rect><rect class="bar series-31" x="409" y="234.84757227575983" fill="#2C70A9" width="12" height="0.0145169261181195" data-x="2008" data-y="2"><title>Contains only &lt;section&gt; tag, 2008 (2)</title></rect><rect class="bar series-32" x="422" y="234.61530145787003" fill="#2C70A9" width="12" height="0.0798430936496004" data-x="2009" data-y="11"><title>Contains only &lt;section&gt; tag, 2009 (11)</title></rect><rect class="bar series-33" x="435" y="234.46287373362986" fill="#2C70A9" width="12" height="0.13065233506299023" data-x="2010" data-y="18"><title>Contains only &lt;section&gt; tag, 2010 (18)</title></rect><rect class="bar series-34" x="448" y="234.1435013590314" fill="#2C70A9" width="12" height="0.11613540894489915" data-x="2011" data-y="16"><title>Contains only &lt;section&gt; tag, 2011 (16)</title></rect><rect class="bar series-35" x="461" y="231.2981838398814" fill="#2C70A9" width="12" height="0.6750370644922157" data-x="2012" data-y="93"><title>Contains only &lt;section&gt; tag, 2012 (93)</title></rect><rect class="bar series-36" x="474" y="128.46753768223374" fill="#2C70A9" width="12" height="32.77196071163823" data-x="2013" data-y="4515"><title>Contains only &lt;section&gt; tag, 2013 (4515)</title></rect><rect class="bar series-37" x="487" y="51.33185075364467" fill="#2C70A9" width="12" height="57.66123054114158" data-x="2014" data-y="7944"><title>Contains only &lt;section&gt; tag, 2014 (7944)</title></rect><rect class="bar series-38" x="500" y="79.51646281195949" fill="#2C70A9" width="12" height="46.17108351865579" data-x="2015" data-y="6361"><title>Contains only &lt;section&gt; tag, 2015 (6361)</title></rect></g><g class="bar-group"><rect class="bar series-1" x="19" y="234.99274153694094" fill="#56a0dd" width="12" height="0" data-x="1970" data-y="0"><title>Contains &lt;*.info&gt; tag, 1970 (0)</title></rect><rect class="bar series-2" x="32" y="235" fill="#56a0dd" width="12" height="0" data-x="1976" data-y="0"><title>Contains &lt;*.info&gt; tag, 1976 (0)</title></rect><rect class="bar series-3" x="45" y="235" fill="#56a0dd" width="12" height="0" data-x="1977" data-y="0"><title>Contains &lt;*.info&gt; tag, 1977 (0)</title></rect><rect class="bar series-4" x="58" y="235" fill="#56a0dd" width="12" height="0" data-x="1979" data-y="0"><title>Contains &lt;*.info&gt; tag, 1979 (0)</title></rect><rect class="bar series-5" x="71" y="235" fill="#56a0dd" width="12" height="0" data-x="1982" data-y="0"><title>Contains &lt;*.info&gt; tag, 1982 (0)</title></rect><rect class="bar series-6" x="84" y="235" fill="#56a0dd" width="12" height="0" data-x="1983" data-y="0"><title>Contains &lt;*.info&gt; tag, 1983 (0)</title></rect><rect class="bar series-7" x="97" y="235" fill="#56a0dd" width="12" height="0" data-x="1984" data-y="0"><title>Contains &lt;*.info&gt; tag, 1984 (0)</title></rect><rect class="bar series-8" x="110" y="235" fill="#56a0dd" width="12" height="0" data-x="1985" data-y="0"><title>Contains &lt;*.info&gt; tag, 1985 (0)</title></rect><rect class="bar series-9" x="123" y="235" fill="#56a0dd" width="12" height="0" data-x="1986" data-y="0"><title>Contains &lt;*.info&gt; tag, 1986 (0)</title></rect><rect class="bar series-10" x="136" y="235" fill="#56a0dd" width="12" height="0" data-x="1987" data-y="0"><title>Contains &lt;*.info&gt; tag, 1987 (0)</title></rect><rect class="bar series-11" x="149" y="235" fill="#56a0dd" width="12" height="0" data-x="1988" data-y="0"><title>Contains &lt;*.info&gt; tag, 1988 (0)</title></rect><rect class="bar series-12" x="162" y="234.99274153694094" fill="#56a0dd" width="12" height="0" data-x="1989" data-y="0"><title>Contains &lt;*.info&gt; tag, 1989 (0)</title></rect><rect class="bar series-13" x="175" y="234.99274153694094" fill="#56a0dd" width="12" height="0" data-x="1990" data-y="0"><title>Contains &lt;*.info&gt; tag, 1990 (0)</title></rect><rect class="bar series-14" x="188" y="234.99274153694094" fill="#56a0dd" width="12" height="0" data-x="1991" data-y="0"><title>Contains &lt;*.info&gt; tag, 1991 (0)</title></rect><rect class="bar series-15" x="201" y="235" fill="#56a0dd" width="12" height="0" data-x="1992" data-y="0"><title>Contains &lt;*.info&gt; tag, 1992 (0)</title></rect><rect class="bar series-16" x="214" y="235" fill="#56a0dd" width="12" height="0" data-x="1993" data-y="0"><title>Contains &lt;*.info&gt; tag, 1993 (0)</title></rect><rect class="bar series-17" x="227" y="235" fill="#56a0dd" width="12" height="0" data-x="1994" data-y="0"><title>Contains &lt;*.info&gt; tag, 1994 (0)</title></rect><rect class="bar series-18" x="240" y="234.99274153694094" fill="#56a0dd" width="12" height="0" data-x="1995" data-y="0"><title>Contains &lt;*.info&gt; tag, 1995 (0)</title></rect><rect class="bar series-19" x="253" y="235" fill="#56a0dd" width="12" height="0" data-x="1996" data-y="0"><title>Contains &lt;*.info&gt; tag, 1996 (0)</title></rect><rect class="bar series-20" x="266" y="234.98548307388188" fill="#56a0dd" width="12" height="0" data-x="1997" data-y="0"><title>Contains &lt;*.info&gt; tag, 1997 (0)</title></rect><rect class="bar series-21" x="279" y="235" fill="#56a0dd" width="12" height="0" data-x="1998" data-y="0"><title>Contains &lt;*.info&gt; tag, 1998 (0)</title></rect><rect class="bar series-22" x="292" y="234.99274153694094" fill="#56a0dd" width="12" height="0" data-x="1999" data-y="0"><title>Contains &lt;*.info&gt; tag, 1999 (0)</title></rect><rect class="bar series-23" x="305" y="234.94193229552755" fill="#56a0dd" width="12" height="0" data-x="2000" data-y="0"><title>Contains &lt;*.info&gt; tag, 2000 (0)</title></rect><rect class="bar series-24" x="318" y="234.9709661477638" fill="#56a0dd" width="12" height="0" data-x="2001" data-y="0"><title>Contains &lt;*.info&gt; tag, 2001 (0)</title></rect><rect class="bar series-25" x="331" y="234.94193229552755" fill="#56a0dd" width="12" height="0" data-x="2002" data-y="0"><title>Contains &lt;*.info&gt; tag, 2002 (0)</title></rect><rect class="bar series-26" x="344" y="234.94193229552755" fill="#56a0dd" width="12" height="0" data-x="2003" data-y="0"><title>Contains &lt;*.info&gt; tag, 2003 (0)</title></rect><rect class="bar series-27" x="357" y="234.9491907585866" fill="#56a0dd" width="12" height="0" data-x="2004" data-y="0"><title>Contains &lt;*.info&gt; tag, 2004 (0)</title></rect><rect class="bar series-28" x="370" y="234.96370768470473" fill="#56a0dd" width="12" height="0" data-x="2005" data-y="0"><title>Contains &lt;*.info&gt; tag, 2005 (0)</title></rect><rect class="bar series-29" x="383" y="234.9491907585866" fill="#56a0dd" width="12" height="0" data-x="2006" data-y="0"><title>Contains &lt;*.info&gt; tag, 2006 (0)</title></rect><rect class="bar series-30" x="396" y="234.86208920187795" fill="#56a0dd" width="12" height="0" data-x="2007" data-y="0"><title>Contains &lt;*.info&gt; tag, 2007 (0)</title></rect><rect class="bar series-31" x="409" y="234.84757227575983" fill="#56a0dd" width="12" height="0" data-x="2008" data-y="0"><title>Contains &lt;*.info&gt; tag, 2008 (0)</title></rect><rect class="bar series-32" x="422" y="234.61530145787003" fill="#56a0dd" width="12" height="0" data-x="2009" data-y="0"><title>Contains &lt;*.info&gt; tag, 2009 (0)</title></rect><rect class="bar series-33" x="435" y="234.46287373362986" fill="#56a0dd" width="12" height="0" data-x="2010" data-y="0"><title>Contains &lt;*.info&gt; tag, 2010 (0)</title></rect><rect class="bar series-34" x="448" y="234.1435013590314" fill="#56a0dd" width="12" height="0" data-x="2011" data-y="0"><title>Contains &lt;*.info&gt; tag, 2011 (0)</title></rect><rect class="bar series-35" x="461" y="231.29092537682234" fill="#56a0dd" width="12" height="0.00725846305905975" data-x="2012" data-y="1"><title>Contains &lt;*.info&gt; tag, 2012 (1)</title></rect><rect class="bar series-36" x="474" y="128.4457622930566" fill="#56a0dd" width="12" height="0.02177538917717925" data-x="2013" data-y="3"><title>Contains &lt;*.info&gt; tag, 2013 (3)</title></rect><rect class="bar series-37" x="487" y="51.266524586113164" fill="#56a0dd" width="12" height="0.06532616753150933" data-x="2014" data-y="9"><title>Contains &lt;*.info&gt; tag, 2014 (9)</title></rect><rect class="bar series-38" x="500" y="79.44387818136892" fill="#56a0dd" width="12" height="0.07258463059056908" data-x="2015" data-y="10"><title>Contains &lt;*.info&gt; tag, 2015 (10)</title></rect></g><g class="bar-group"><rect class="bar series-1" x="19" y="234.99274153694094" fill="#9DCBF1" width="12" height="0" data-x="1970" data-y="0"><title>Contains neither &lt;*.info&gt; tag nor &lt;section&gt; tag, 1970 (0)</title></rect><rect class="bar series-2" x="32" y="234.99274153694094" fill="#9DCBF1" width="12" height="0.00725846305905975" data-x="1976" data-y="1"><title>Contains neither &lt;*.info&gt; tag nor &lt;section&gt; tag, 1976 (1)</title></rect><rect class="bar series-3" x="45" y="234.98548307388188" fill="#9DCBF1" width="12" height="0.0145169261181195" data-x="1977" data-y="2"><title>Contains neither &lt;*.info&gt; tag nor &lt;section&gt; tag, 1977 (2)</title></rect><rect class="bar series-4" x="58" y="234.99274153694094" fill="#9DCBF1" width="12" height="0.00725846305905975" data-x="1979" data-y="1"><title>Contains neither &lt;*.info&gt; tag nor &lt;section&gt; tag, 1979 (1)</title></rect><rect class="bar series-5" x="71" y="234.99274153694094" fill="#9DCBF1" width="12" height="0.00725846305905975" data-x="1982" data-y="1"><title>Contains neither &lt;*.info&gt; tag nor &lt;section&gt; tag, 1982 (1)</title></rect><rect class="bar series-6" x="84" y="234.9709661477638" fill="#9DCBF1" width="12" height="0.029033852236210578" data-x="1983" data-y="4"><title>Contains neither &lt;*.info&gt; tag nor &lt;section&gt; tag, 1983 (4)</title></rect><rect class="bar series-7" x="97" y="234.9491907585866" fill="#9DCBF1" width="12" height="0.05080924141338983" data-x="1984" data-y="7"><title>Contains neither &lt;*.info&gt; tag nor &lt;section&gt; tag, 1984 (7)</title></rect><rect class="bar series-8" x="110" y="234.9346738324685" fill="#9DCBF1" width="12" height="0.06532616753150933" data-x="1985" data-y="9"><title>Contains neither &lt;*.info&gt; tag nor &lt;section&gt; tag, 1985 (9)</title></rect><rect class="bar series-9" x="123" y="234.89838151717322" fill="#9DCBF1" width="12" height="0.10161848282677965" data-x="1986" data-y="14"><title>Contains neither &lt;*.info&gt; tag nor &lt;section&gt; tag, 1986 (14)</title></rect><rect class="bar series-10" x="136" y="234.89838151717322" fill="#9DCBF1" width="12" height="0.10161848282677965" data-x="1987" data-y="14"><title>Contains neither &lt;*.info&gt; tag nor &lt;section&gt; tag, 1987 (14)</title></rect><rect class="bar series-11" x="149" y="234.91289844329134" fill="#9DCBF1" width="12" height="0.08710155670866015" data-x="1988" data-y="12"><title>Contains neither &lt;*.info&gt; tag nor &lt;section&gt; tag, 1988 (12)</title></rect><rect class="bar series-12" x="162" y="234.869347664937" fill="#9DCBF1" width="12" height="0.12339387200393048" data-x="1989" data-y="17"><title>Contains neither &lt;*.info&gt; tag nor &lt;section&gt; tag, 1989 (17)</title></rect><rect class="bar series-13" x="175" y="234.89838151717322" fill="#9DCBF1" width="12" height="0.0943600197677199" data-x="1990" data-y="13"><title>Contains neither &lt;*.info&gt; tag nor &lt;section&gt; tag, 1990 (13)</title></rect><rect class="bar series-14" x="188" y="234.92741536940943" fill="#9DCBF1" width="12" height="0.06532616753150933" data-x="1991" data-y="9"><title>Contains neither &lt;*.info&gt; tag nor &lt;section&gt; tag, 1991 (9)</title></rect><rect class="bar series-15" x="201" y="234.869347664937" fill="#9DCBF1" width="12" height="0.13065233506299023" data-x="1992" data-y="18"><title>Contains neither &lt;*.info&gt; tag nor &lt;section&gt; tag, 1992 (18)</title></rect><rect class="bar series-16" x="214" y="234.80402149740547" fill="#9DCBF1" width="12" height="0.19597850259452798" data-x="1993" data-y="27"><title>Contains neither &lt;*.info&gt; tag nor &lt;section&gt; tag, 1993 (27)</title></rect><rect class="bar series-17" x="227" y="233.90397207808252" fill="#9DCBF1" width="12" height="1.0960279219174822" data-x="1994" data-y="151"><title>Contains neither &lt;*.info&gt; tag nor &lt;section&gt; tag, 1994 (151)</title></rect><rect class="bar series-18" x="240" y="231.1457561156412" fill="#9DCBF1" width="12" height="3.8469854212997348" data-x="1995" data-y="530"><title>Contains neither &lt;*.info&gt; tag nor &lt;section&gt; tag, 1995 (530)</title></rect><rect class="bar series-19" x="253" y="230.87719298245614" fill="#9DCBF1" width="12" height="4.122807017543863" data-x="1996" data-y="568"><title>Contains neither &lt;*.info&gt; tag nor &lt;section&gt; tag, 1996 (568)</title></rect><rect class="bar series-20" x="266" y="229.73761428218432" fill="#9DCBF1" width="12" height="5.247868791697556" data-x="1997" data-y="723"><title>Contains neither &lt;*.info&gt; tag nor &lt;section&gt; tag, 1997 (723)</title></rect><rect class="bar series-21" x="279" y="227.39313071410922" fill="#9DCBF1" width="12" height="7.606869285890781" data-x="1998" data-y="1048"><title>Contains neither &lt;*.info&gt; tag nor &lt;section&gt; tag, 1998 (1048)</title></rect><rect class="bar series-22" x="292" y="218.59587348653324" fill="#9DCBF1" width="12" height="16.396868050407704" data-x="1999" data-y="2259"><title>Contains neither &lt;*.info&gt; tag nor &lt;section&gt; tag, 1999 (2259)</title></rect><rect class="bar series-23" x="305" y="195.43411786508526" fill="#9DCBF1" width="12" height="39.507814430442295" data-x="2000" data-y="5443"><title>Contains neither &lt;*.info&gt; tag nor &lt;section&gt; tag, 2000 (5443)</title></rect><rect class="bar series-24" x="318" y="178.65255127254758" fill="#9DCBF1" width="12" height="56.318414875216206" data-x="2001" data-y="7759"><title>Contains neither &lt;*.info&gt; tag nor &lt;section&gt; tag, 2001 (7759)</title></rect><rect class="bar series-25" x="331" y="153.51649369903632" fill="#9DCBF1" width="12" height="81.42543859649123" data-x="2002" data-y="11218"><title>Contains neither &lt;*.info&gt; tag nor &lt;section&gt; tag, 2002 (11218)</title></rect><rect class="bar series-26" x="344" y="142.5271806276254" fill="#9DCBF1" width="12" height="92.41475166790215" data-x="2003" data-y="12732"><title>Contains neither &lt;*.info&gt; tag nor &lt;section&gt; tag, 2003 (12732)</title></rect><rect class="bar series-27" x="357" y="123.82212132443784" fill="#9DCBF1" width="12" height="111.12706943414877" data-x="2004" data-y="15310"><title>Contains neither &lt;*.info&gt; tag nor &lt;section&gt; tag, 2004 (15310)</title></rect><rect class="bar series-28" x="370" y="109.3342290585619" fill="#9DCBF1" width="12" height="125.62947862614283" data-x="2005" data-y="17308"><title>Contains neither &lt;*.info&gt; tag nor &lt;section&gt; tag, 2005 (17308)</title></rect><rect class="bar series-29" x="383" y="85.55550407709414" fill="#9DCBF1" width="12" height="149.39368668149245" data-x="2006" data-y="20582"><title>Contains neither &lt;*.info&gt; tag nor &lt;section&gt; tag, 2006 (20582)</title></rect><rect class="bar series-30" x="396" y="66.35686928589078" fill="#9DCBF1" width="12" height="168.50521991598714" data-x="2007" data-y="23215"><title>Contains neither &lt;*.info&gt; tag nor &lt;section&gt; tag, 2007 (23215)</title></rect><rect class="bar series-31" x="409" y="46.80982826785273" fill="#9DCBF1" width="12" height="188.0377440079071" data-x="2008" data-y="25906"><title>Contains neither &lt;*.info&gt; tag nor &lt;section&gt; tag, 2008 (25906)</title></rect><rect class="bar series-32" x="422" y="30.950086483815173" fill="#9DCBF1" width="12" height="203.66521497405486" data-x="2009" data-y="28059"><title>Contains neither &lt;*.info&gt; tag nor &lt;section&gt; tag, 2009 (28059)</title></rect><rect class="bar series-33" x="435" y="17.652582159624412" fill="#9DCBF1" width="12" height="216.81029157400545" data-x="2010" data-y="29870"><title>Contains neither &lt;*.info&gt; tag nor &lt;section&gt; tag, 2010 (29870)</title></rect><rect class="bar series-34" x="448" y="0" fill="#9DCBF1" width="12" height="234.14350135903138" data-x="2011" data-y="32258"><title>Contains neither &lt;*.info&gt; tag nor &lt;section&gt; tag, 2011 (32258)</title></rect><rect class="bar series-35" x="461" y="5.748702742772424" fill="#9DCBF1" width="12" height="225.54222263404992" data-x="2012" data-y="31073"><title>Contains neither &lt;*.info&gt; tag nor &lt;section&gt; tag, 2012 (31073)</title></rect><rect class="bar series-36" x="474" y="9.566654311835928" fill="#9DCBF1" width="12" height="118.87910798122066" data-x="2013" data-y="16378"><title>Contains neither &lt;*.info&gt; tag nor &lt;section&gt; tag, 2013 (16378)</title></rect><rect class="bar series-37" x="487" y="10.11829750432419" fill="#9DCBF1" width="12" height="41.148227081788974" data-x="2014" data-y="5669"><title>Contains neither &lt;*.info&gt; tag nor &lt;section&gt; tag, 2014 (5669)</title></rect><rect class="bar series-38" x="500" y="50.33018285149493" fill="#9DCBF1" width="12" height="29.113695329873963" data-x="2015" data-y="4011"><title>Contains neither &lt;*.info&gt; tag nor &lt;section&gt; tag, 2015 (4011)</title></rect></g></g></g><a xlink:href="http://rechtspraak.cloudant.com/docs/_design/stats/_view/richness_of_markup?group_level=2&amp;stale=ok"><text style="text-decoration:underline;fill:#0000EE;" text-anchor="start" x="12" y="20">Data source</text></a></svg></div><figcaption><span class="figure-number">Fig 1.</span> Chart showing the number of documents with different kinds of markup. In particular, we are interested in the number of <code>*.info</code> tags, which are headers that contain metadata about the case, and <code>section</code> tags, denoting sections.</figcaption></figure></div></section><section id="problem-description"><h3 class="title"><a class="link-up" href="#"></a>Problem Description</h3><div><div style="page-break-inside:avoid;"><p>The problem that we investigate in this thesis, then, is whether we can enrich the markup of scarcely marked up documents in Rechtspraak.nl by automatically assigning a section hierarchy to the text elements. We divide this problem in the following subtasks:</p><ol><li><a href="#importing">Importing documents from the Rechtspraak.nl web service;</a></li><li><a href="#importing">Tokenizing relevant text elements;</a></li><li><a href="../tagging/">Labeling these text elements with their respective roles (i.e. <code>section title</code>; <code>numbering</code>; <code>text block</code>; <code>newline</code>);</a></li><li><a href="../document-structure/">Combining the tokens in such a way that they represent the most likely section hierarchy;</a></li><li style="display:none;">Publishing the resulting documents so that search engines can make use of the enriched markup</li></ol></div><p>Tasks 1 and 2 are theoretically straightforward and mostly a problem of implementation, and the following chapter touches on these subject briefly, including a specification of the data set used.</p><p>Tasks 3 and 4 require more complicated machinery than importing and tokenization, so these topics merit their own chapter. These chapters are similarly structured: we introduce the problem to solve, the methods used, and report experimental results.</p></div></section></section></div><div><section class="chapter"><h2 class="title"><a class="link-up" href="#"></a>Tagging Elements</h2><section id="tagging-introduction"><h3 class="title"><a class="link-up" href="#"></a>Introduction</h3><div><p>In the <a href="../introduction/">previous chapter</a> we developed a way to import Rechtspraak.nl XML documents and distill them into a list of text elements, or tokens. In this chapter, we consider how to label these tokens with any of four labels:</p><ol><li><code>numbering</code>, for numbering in a section heading</li><li><code>title text</code>, for text in a section heading</li><li><code>text block</code>, for running text outside of a section heading</li><li><code>newline</code>, for newlines</li></ol><p>Even as a human reader, it can be hard to distinguish what should properly be called a section, and so what is a section heading. So there is some subjectivity involved in tagging. Consider, for example, a numbered enumeration of facts which might be considered a list or a section sequence. For our purposes, we take the radical stance to call a &#x27;section&#x27; any semantic grouping of text that is headed by a title or a number, inspired by the HTML5 definition of <code>section</code>:</p><blockquote>A section is a thematic grouping of content. The theme of each section should be identified, typically by including a heading (h1-h6 element) as a child of the section element.</blockquote><p>Labeling a string of tokens is a task that has been widely covered in literature, mostly in the application of part-of-speech tagging in natural language. Popular methods include graphical models, which model the probability distributions of labels and observations occurring together. These include Hidden Markov Models (HMMs) and the closely related Conditional Random Fields (CRFs). In this chapter, we experiment with CRFs for labeling our tokens, and we compare the results to a hand-written deterministic tagger that utilizes similar features. It turns out that both models score around 1.0 on all labels except section titles. For section titles, CRFs significantly out-perform the hand-written tagger in terms of recall, while trading in some precision. For section titles, the hand-written tagger has a precision of 0.96 and recall of 0.74; the trained CRF of 0.91 and 0.91, respectively.</p></div></section><section id="tagging-methods"><h3 class="title"><a class="link-up" href="#"></a>Methods</h3><div><section id="feature-selection"><h4 class="title"><a class="link-up" href="#"></a>Feature Selection</h4><div><p>Based on the metrics and observations from the <a href="../introduction/#rechtspraak-nl-data-set">previous chapter</a>, we define about 250 binary features for our automatic tagger. The most prominent ones include:</p><ul><li>word count (text block contains 1, 2, 3, 4, 5â€”10 or more than 10 words)</li><li>whether the token is preceded or followed by any of a number of features, such as numberings or inline text</li><li>whether the token contains bracketed text</li><li>whether the token matches a known title (similar titles are consolidated into regular expressions)</li></ul><srike>The full set of features is can be accessed from the <a href=""><code>Features</code> class</a> in the source code.</srike><p>We use these features in a probabilistic tagger for which we train a CRF model, and also for a hand-written deterministic tagger. We now introduce these models, with a sizeable introduction on Conditional Random Fields, and conclude with a section that reports their experimental results.</p></div></section><section id="crf"><h4 class="title"><a class="link-up" href="#"></a>Conditional Random Fields</h4><div><p>Conditional Random Fields (CRFs) are a class of statistical modelling methods that were first introduced in <a class="inline-citation" href="#mccallum2000maximum">Freitag et al. (2000, pp. 591â€”598)</a> as a non-generative (i.e., discriminative) alternative to Hidden Markov Models (HMMs). This means that instead of modeling the joint probability <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><mi mathvariant="bold">x</mi><mo separator="true">,</mo><mi mathvariant="bold">y</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">p(\mathbf x,\mathbf y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mpunct">,</span><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="mclose">)</span></span></span></span></span> of the observation vector <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="bold">x</mi></mrow><annotation encoding="application/x-tex">\mathbf x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.44444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathbf">x</span></span></span></span></span> and label vector <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="bold">y</mi></mrow><annotation encoding="application/x-tex">\mathbf y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.63888em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span></span></span> occurring together, we model the conditional probability <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><mi mathvariant="bold">y</mi><mi mathvariant="normal">âˆ£</mi><mi mathvariant="bold">x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">p(\mathbf y|\mathbf x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="mord mathrm">âˆ£</span><span class="mord mathbf">x</span><span class="mclose">)</span></span></span></span></span> of labels <em>given</em> the observations. CRFs do not explicitly model <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><mi mathvariant="bold">x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">p(\mathbf x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mclose">)</span></span></span></span></span>, just <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><mi mathvariant="bold">y</mi><mi mathvariant="normal">âˆ£</mi><mi mathvariant="bold">x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">p(\mathbf y|\mathbf x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="mord mathrm">âˆ£</span><span class="mord mathbf">x</span><span class="mclose">)</span></span></span></span></span>, and so we can use a very rich set of features <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="bold">x</mi></mrow><annotation encoding="application/x-tex">\mathbf x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.44444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathbf">x</span></span></span></span></span> and still have a tractable model. As such, CRFs can model a complex interdependence of observation variables, and are therefore popular in pattern recognition tasks</p><p>As illustrated in <a href="#fig-models-relationships">Figure 1</a>, CRFs can be understood as a graphical version of logistic regression, in which we have an arbitrary number of dependant variables that are conditioned on a number of explanatory variables (instead of just one dependant variable).</p><p>In this thesis, we limit ourselves to a subclass of CRFs called Linear-Chain Conditional Random Fields (LC-CRFs or Linear Chain CRFs), which is topologically very similar to HMMs: both model a probability distribution along a chain of input variables, where each input variable is also connected to a single output variable.</p><p>To clarify: in our experiments we consider an input document as a string of tokens, where each token should correspond to a label of either <code>title</code>, <code>nr</code>, <code>text</code> or <code>newline</code>.</p><p>Because of the freedom that CRFs permit for the input vector, CRFs tend to have many features: <a class="inline-citation" href="#klinger2009feature">Klinger et al. (2009, pp. 185â€”191)</a> even reports millions of features.</p><p>This abundance of features likely explains that CRFs tend to have state-of-the-art performance on NLP tasks such as part-of-speech tagging, since this kind of performance appears to depend on extensive feature engineering. As a downside, it is more likely that a model overfits to a particular corpus, and so suffers in portability with respect to other copora. (Consider <a class="inline-citation" href="#finkel2004exploiting">Finkel et al. (2004, pp. 88â€”91)</a>.) In our case, this is likely not a problem because we train explicitly for one corpus, and do not aspire to full language abstraction.</p><p>In this section, we provide a definition of Linear-Chain Conditional Random Fields, supported first by introductory sections on <a href="#graphical-models">graphical models</a> and <a href="#hmm">Hidden Markov Models</a>.</p><p>For a more thorough tutorial into CRFs, including skip-chain CRFs, one may refer to <a class="inline-citation" href="#sutton2006introduction">McCallum &amp; Sutton (2006, pp. 93â€”128)</a>.</p></div></section></div><section id="feature-selection"><h4 class="title"><a class="link-up" href="#"></a>Feature Selection</h4><div><p>Based on the metrics and observations from the <a href="../introduction/#rechtspraak-nl-data-set">previous chapter</a>, we define about 250 binary features for our automatic tagger. The most prominent ones include:</p><ul><li>word count (text block contains 1, 2, 3, 4, 5â€”10 or more than 10 words)</li><li>whether the token is preceded or followed by any of a number of features, such as numberings or inline text</li><li>whether the token contains bracketed text</li><li>whether the token matches a known title (similar titles are consolidated into regular expressions)</li></ul><srike>The full set of features is can be accessed from the <a href=""><code>Features</code> class</a> in the source code.</srike><p>We use these features in a probabilistic tagger for which we train a CRF model, and also for a hand-written deterministic tagger. We now introduce these models, with a sizeable introduction on Conditional Random Fields, and conclude with a section that reports their experimental results.</p></div></section><section id="crf"><h4 class="title"><a class="link-up" href="#"></a>Conditional Random Fields</h4><div><p>Conditional Random Fields (CRFs) are a class of statistical modelling methods that were first introduced in <a class="inline-citation" href="#mccallum2000maximum">Freitag et al. (2000, pp. 591â€”598)</a> as a non-generative (i.e., discriminative) alternative to Hidden Markov Models (HMMs). This means that instead of modeling the joint probability <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><mi mathvariant="bold">x</mi><mo separator="true">,</mo><mi mathvariant="bold">y</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">p(\mathbf x,\mathbf y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mpunct">,</span><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="mclose">)</span></span></span></span></span> of the observation vector <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="bold">x</mi></mrow><annotation encoding="application/x-tex">\mathbf x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.44444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathbf">x</span></span></span></span></span> and label vector <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="bold">y</mi></mrow><annotation encoding="application/x-tex">\mathbf y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.63888em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span></span></span> occurring together, we model the conditional probability <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><mi mathvariant="bold">y</mi><mi mathvariant="normal">âˆ£</mi><mi mathvariant="bold">x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">p(\mathbf y|\mathbf x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="mord mathrm">âˆ£</span><span class="mord mathbf">x</span><span class="mclose">)</span></span></span></span></span> of labels <em>given</em> the observations. CRFs do not explicitly model <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><mi mathvariant="bold">x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">p(\mathbf x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mclose">)</span></span></span></span></span>, just <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><mi mathvariant="bold">y</mi><mi mathvariant="normal">âˆ£</mi><mi mathvariant="bold">x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">p(\mathbf y|\mathbf x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="mord mathrm">âˆ£</span><span class="mord mathbf">x</span><span class="mclose">)</span></span></span></span></span>, and so we can use a very rich set of features <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="bold">x</mi></mrow><annotation encoding="application/x-tex">\mathbf x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.44444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathbf">x</span></span></span></span></span> and still have a tractable model. As such, CRFs can model a complex interdependence of observation variables, and are therefore popular in pattern recognition tasks</p><p>As illustrated in <a href="#fig-models-relationships">Figure 1</a>, CRFs can be understood as a graphical version of logistic regression, in which we have an arbitrary number of dependant variables that are conditioned on a number of explanatory variables (instead of just one dependant variable).</p><p>In this thesis, we limit ourselves to a subclass of CRFs called Linear-Chain Conditional Random Fields (LC-CRFs or Linear Chain CRFs), which is topologically very similar to HMMs: both model a probability distribution along a chain of input variables, where each input variable is also connected to a single output variable.</p><p>To clarify: in our experiments we consider an input document as a string of tokens, where each token should correspond to a label of either <code>title</code>, <code>nr</code>, <code>text</code> or <code>newline</code>.</p><p>Because of the freedom that CRFs permit for the input vector, CRFs tend to have many features: <a class="inline-citation" href="#klinger2009feature">Klinger et al. (2009, pp. 185â€”191)</a> even reports millions of features.</p><p>This abundance of features likely explains that CRFs tend to have state-of-the-art performance on NLP tasks such as part-of-speech tagging, since this kind of performance appears to depend on extensive feature engineering. As a downside, it is more likely that a model overfits to a particular corpus, and so suffers in portability with respect to other copora. (Consider <a class="inline-citation" href="#finkel2004exploiting">Finkel et al. (2004, pp. 88â€”91)</a>.) In our case, this is likely not a problem because we train explicitly for one corpus, and do not aspire to full language abstraction.</p><p>In this section, we provide a definition of Linear-Chain Conditional Random Fields, supported first by introductory sections on <a href="#graphical-models">graphical models</a> and <a href="#hmm">Hidden Markov Models</a>.</p><p>For a more thorough tutorial into CRFs, including skip-chain CRFs, one may refer to <a class="inline-citation" href="#sutton2006introduction">McCallum &amp; Sutton (2006, pp. 93â€”128)</a>.</p></div><section id="graphical-models"><h5 class="title"><a class="link-up" href="#"></a>Graphical Models</h5><div><p>Graphical models are statistical models where the probility function can be represented as a <a href="https://en.wikipedia.org/wiki/Factor_graph">factor graph</a>. Graphical models include Bayesian networks, HMMs, CRFs and logistic regression models.</p><figure id="fig-models-relationships"><div class="figure-img-container"><img style="display:inline-block;" src="..//img/graphical-models.svg" alt="Diagram of the relationship between naive Bayes, logistic regression, HMMs, linear-chain CRFs, generative models, and general CRFs"/></div><figcaption><span class="figure-number">Fig 1.</span> Diagram of the relationship between naive Bayes, logistic regression, HMMs, linear-chain CRFs, Bayesian models, and general CRFs. Image adapted from <a class="inline-citation" href="#sutton2006introduction">McCallum &amp; Sutton (2006, pp. 93â€”128)</a>.</figcaption></figure><p>We now formally define graphical models. Assume we have a set <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>V</mi><mo>=</mo><mi>X</mi><mo>âˆª</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">V=X\cup Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.07847em;">X</span><span class="mbin">âˆª</span><span class="mord mathit" style="margin-right:0.22222em;">Y</span></span></span></span></span> of random variables which can take values from a set <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="script">V</mi></mrow></mrow><annotation encoding="application/x-tex">\mathcal{V}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.08222em;">V</span></span></span></span></span></span>. Here <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07847em;">X</span></span></span></span></span>denotes a set of input variables (for example, word features) and <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.22222em;">Y</span></span></span></span></span> denotes a set of output variables (for example, part-of-speech tags). We denote an assignment to <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07847em;">X</span></span></span></span></span> and <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.22222em;">Y</span></span></span></span></span> with <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="bold">x</mi></mrow><annotation encoding="application/x-tex">\mathbf x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.44444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathbf">x</span></span></span></span></span> and <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="bold">y</mi></mrow><annotation encoding="application/x-tex">\mathbf y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.63888em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span></span></span>, respectively. An undirected graphical model is defined as the set of all probability distributions that can be written as <span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><msub><mi mathvariant="bold">x</mi><mi>A</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">y</mi><mi>A</mi></msub><mo>)</mo><mo>=</mo><mfrac><mrow><mn>1</mn></mrow><mrow><mi>Z</mi></mrow></mfrac><msub><mo>âˆ</mo><mi>A</mi></msub><msub><mi mathvariant="normal">Î¦</mi><mi>A</mi></msub><mo>(</mo><msub><mi mathvariant="bold">x</mi><mi>A</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">y</mi><mi>A</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">p( \mathbf x_A, \mathbf y_A)=\frac{1}{Z}\prod _A \Phi_A( \mathbf x_A,\mathbf y_A)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.32144em;"></span><span class="strut bottom" style="height:2.615776em;vertical-align:-1.294336em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class=""><span class="mord mathbf">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">A</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class=""><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="vlist"><span style="top:0.24444em;margin-right:0.05em;margin-left:-0.01597em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">A</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit" style="margin-right:0.07153em;">Z</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mop op-limits"><span class="vlist"><span style="top:1.1943359999999998em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">A</span></span></span><span style="top:-0.000005000000000143778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span><span class="op-symbol large-op mop">âˆ</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathrm">Î¦</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">A</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class=""><span class="mord mathbf">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">A</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class=""><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="vlist"><span style="top:0.24444em;margin-right:0.05em;margin-left:-0.01597em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">A</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span></span></span>where <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">Î¦</mi><mi>A</mi></msub><mo>âˆˆ</mo><mi>F</mi></mrow><annotation encoding="application/x-tex">\Phi_A \in F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathrm">Î¦</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">A</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">âˆˆ</span><span class="mord mathit" style="margin-right:0.13889em;">F</span></span></span></span></span> is a factor defined on some subset of variables <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mo>âŠ†</mo><mi>V</mi></mrow><annotation encoding="application/x-tex">A \subseteq V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.8193em;vertical-align:-0.13597em;"></span><span class="base textstyle uncramped"><span class="mord mathit">A</span><span class="mrel">âŠ†</span><span class="mord mathit" style="margin-right:0.22222em;">V</span></span></span></span></span> and <span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Z</mi><mo>=</mo><msub><mo>âˆ‘</mo><mrow><mi mathvariant="bold">x</mi><mo separator="true">,</mo><mi mathvariant="bold">y</mi></mrow></msub><mo>(</mo><msub><mo>âˆ</mo><mi>A</mi></msub><msub><mi mathvariant="normal">Î¦</mi><mi>A</mi></msub><mo>(</mo><msub><mi mathvariant="bold">x</mi><mi>A</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">y</mi><mi>A</mi></msub><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">Z=\sum _{\mathbf x, \mathbf y} ( \prod _A \Phi_A( \mathbf x_A,\mathbf y_A))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.0500050000000003em;"></span><span class="strut bottom" style="height:2.4361180000000004em;vertical-align:-1.386113em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">Z</span><span class="mrel">=</span><span class="mop op-limits"><span class="vlist"><span style="top:1.150005em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathbf">x</span><span class="mpunct">,</span><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span></span><span style="top:-0.000005000000000143778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span><span class="op-symbol large-op mop">âˆ‘</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mop op-limits"><span class="vlist"><span style="top:1.1943359999999998em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">A</span></span></span><span style="top:-0.000005000000000143778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span><span class="op-symbol large-op mop">âˆ</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathrm">Î¦</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">A</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class=""><span class="mord mathbf">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">A</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class=""><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="vlist"><span style="top:0.24444em;margin-right:0.05em;margin-left:-0.01597em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">A</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></span></p><p>Intuitively, <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><msub><mi mathvariant="bold">x</mi><mi>A</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">y</mi><mi>A</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">p( \mathbf x_A, \mathbf y_A)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class=""><span class="mord mathbf">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">A</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class=""><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="vlist"><span style="top:0.24444em;margin-right:0.05em;margin-left:-0.01597em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">A</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span></span> describes the joint probability of input and output vectors in terms of some set of functions <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi><mo>=</mo><mo>{</mo><msub><mi mathvariant="normal">Î¦</mi><mi>A</mi></msub><mo>}</mo></mrow><annotation encoding="application/x-tex">F = \{  \Phi_A\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">F</span><span class="mrel">=</span><span class="mopen">{</span><span class="mord"><span class="mord mathrm">Î¦</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">A</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">}</span></span></span></span></span>, collectively known as the factors. We will see that these factors wrap feature values (for example, <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span></span></span></span></span> if a word is capitalized), multiplied together. The normalization term <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Z</mi></mrow><annotation encoding="application/x-tex">Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">Z</span></span></span></span></span> ensures that the probability function ranges between <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">0</span></span></span></span></span> and <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span></span></span></span></span>: it sums every possible value of the the multiplied factors. <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">Î¦</mi><mi>A</mi></msub><mo>âˆˆ</mo><mi>F</mi></mrow><annotation encoding="application/x-tex">\Phi_A \in F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathrm">Î¦</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">A</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">âˆˆ</span><span class="mord mathit" style="margin-right:0.13889em;">F</span></span></span></span></span> can be any function from <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mo>âŠ‚</mo><mi>V</mi></mrow><annotation encoding="application/x-tex">A \subset V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="base textstyle uncramped"><span class="mord mathit">A</span><span class="mrel">âŠ‚</span><span class="mord mathit" style="margin-right:0.22222em;">V</span></span></span></span></span> to a positive real number, i.e. <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">Î¦</mi><mi>A</mi></msub><mo>:</mo><msup><mi>V</mi><mi>n</mi></msup><mo>â†’</mo><mtext>Â </mtext><msup><mrow><mi mathvariant="double-struck">R</mi></mrow><mo>+</mo></msup></mrow><annotation encoding="application/x-tex">\Phi_A:V^n\rightarrow\ \mathbb{R}^+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.771331em;"></span><span class="strut bottom" style="height:0.921331em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathrm">Î¦</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">A</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">:</span><span class="mord"><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">â†’</span><span class="mord mspace">Â </span><span class=""><span class="mord textstyle uncramped"><span class="mord mathbb">R</span></span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord">+</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span></span>. Individually the functions <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">Î¦</mi><mi>A</mi></msub><mo>âˆˆ</mo><mi>F</mi></mrow><annotation encoding="application/x-tex">\Phi_A \in F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathrm">Î¦</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">A</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">âˆˆ</span><span class="mord mathit" style="margin-right:0.13889em;">F</span></span></span></span></span> are known as local functions or compatibility functions.</p><p>It is important to note that <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">F</span></span></span></span></span> is specific to the modeling application. Our choice of factors is what distinguishes graphical models from each other; they are the functions that determine the probability of a given input to have a certain output.</p><p><span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Z</mi></mrow><annotation encoding="application/x-tex">Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">Z</span></span></span></span></span> is called the partition function, because it normalizes the function <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span></span></span></span></span> to ensure that <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mo>âˆ‘</mo><mi>A</mi></msub><mi>p</mi><mo>(</mo><msub><mi mathvariant="bold">x</mi><mi>A</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">y</mi><mi>A</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">\sum_A p(\mathbf x_A,\mathbf y_A)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.0500099999999999em;vertical-align:-0.30001em;"></span><span class="base textstyle uncramped"><span class="mop"><span class="op-symbol small-op mop" style="top:-0.0000050000000000050004em;">âˆ‘</span><span class="vlist"><span style="top:0.30001em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">A</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit">p</span><span class="mopen">(</span><span class=""><span class="mord mathbf">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">A</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class=""><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="vlist"><span style="top:0.24444em;margin-right:0.05em;margin-left:-0.01597em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">A</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span></span> sums to <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span></span></span></span></span>. In general, computing <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Z</mi></mrow><annotation encoding="application/x-tex">Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">Z</span></span></span></span></span> is intractable, because we need to sum over all possible assignments <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="bold">x</mi></mrow><annotation encoding="application/x-tex">\mathbf x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.44444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathbf">x</span></span></span></span></span> of input vectors and all possible assignments <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="bold">y</mi></mrow><annotation encoding="application/x-tex">\mathbf y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.63888em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span></span></span> of output vectors. However, efficient methods to estimate <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Z</mi></mrow><annotation encoding="application/x-tex">Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">Z</span></span></span></span></span> exist.</p><p>The factorization of the function for <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><msub><mi mathvariant="bold">x</mi><mi>A</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">y</mi><mi>A</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">p( \mathbf x_A,\mathbf y_A)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class=""><span class="mord mathbf">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">A</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class=""><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="vlist"><span style="top:0.24444em;margin-right:0.05em;margin-left:-0.01597em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">A</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span></span> can be represented as graph, called a <a href="https://en.wikipedia.org/wiki/Factor_graph">factor graph</a>. (Illustrated in <a href="#fig-factor-graph">Figure 1</a>.)</p><p>Factor graphs are <a class="wiki" href="https://en.wikipedia.org/wiki/Bipartite_graph">bipartite graphs</a> <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi><mo>=</mo><mo>(</mo><mi>V</mi><mo separator="true">,</mo><mi>F</mi><mo separator="true">,</mo><mi>E</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">G=(V,F,E)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">G</span><span class="mrel">=</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.13889em;">F</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="mclose">)</span></span></span></span></span> that link variable nodes <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>v</mi><mi>s</mi></msub><mo>âˆˆ</mo><mi>V</mi></mrow><annotation encoding="application/x-tex">v_s\in V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">âˆˆ</span><span class="mord mathit" style="margin-right:0.22222em;">V</span></span></span></span></span> to function nodes <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">Î¦</mi><mi>A</mi></msub><mo>âˆˆ</mo><mi>F</mi></mrow><annotation encoding="application/x-tex">\Phi_A\in F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathrm">Î¦</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">A</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">âˆˆ</span><span class="mord mathit" style="margin-right:0.13889em;">F</span></span></span></span></span> through edge <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>e</mi><mrow><msub><mi>v</mi><mi>s</mi></msub></mrow><mrow><msub><mi mathvariant="normal">Î¦</mi><mi>A</mi></msub></mrow></msubsup></mrow><annotation encoding="application/x-tex">e^{\Phi_A}_{v_s}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8413309999999999em;"></span><span class="strut bottom" style="height:1.193331em;vertical-align:-0.352em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">e</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="vlist"><span style="top:0.15em;margin-right:0.07142857142857144em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord"><span class="mord mathrm">Î¦</span><span class="vlist"><span style="top:0.15em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord mathit">A</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span></span> iff <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>v</mi><mi>s</mi></msub><mo>âˆˆ</mo><mrow><mi mathvariant="bold">a</mi><mi mathvariant="bold">r</mi><mi mathvariant="bold">g</mi></mrow><mo>(</mo><msub><mi mathvariant="normal">Î¦</mi><mi>A</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">v_s\in \mathbf{arg} ( \Phi_A )</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">âˆˆ</span><span class="mord textstyle uncramped"><span class="mord mathbf">a</span><span class="mord mathbf">r</span><span class="mord mathbf" style="margin-right:0.01597em;">g</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathrm">Î¦</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">A</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span></span>. The graph thus allows us to graphically represent how input and output variables interact with our local functions to generate a probability distribution.</p><figure id="fig-factor-graph"><div class="figure-img-container"><img style="width:55%;display:inline-block;" src="..//img/factor-graph.svg" alt="Illustration of a factor graph. The set V represents all variable nodes; the set F represents all function nodes."/></div><figcaption><span class="figure-number">Fig 1.</span> Illustration of a factor graph. The set V represents all variable nodes; the set F represents all function nodes.</figcaption></figure><p>We define a directed model (or Bayesian Network) as a graphical model that factorizes as:<span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><msub><mi mathvariant="bold">x</mi><mi>A</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">y</mi><mi>A</mi></msub><mo>)</mo><mo>=</mo><msub><mo>âˆ</mo><mrow><mi>v</mi><mo>âˆˆ</mo><mi>V</mi></mrow></msub><mi>p</mi><mo>(</mo><mi>v</mi><mi mathvariant="normal">âˆ£</mi><mi>Ï€</mi><mo>(</mo><mi>v</mi><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">p( \mathbf x_A, \mathbf y_A)=\prod _{v\in V}p(v|\pi(v))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.050005em;"></span><span class="strut bottom" style="height:2.3717110000000003em;vertical-align:-1.321706em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class=""><span class="mord mathbf">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">A</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class=""><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="vlist"><span style="top:0.24444em;margin-right:0.05em;margin-left:-0.01597em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">A</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mop op-limits"><span class="vlist"><span style="top:1.194336em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mrel">âˆˆ</span><span class="mord mathit" style="margin-right:0.22222em;">V</span></span></span></span><span style="top:-0.000005000000000032756em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span><span class="op-symbol large-op mop">âˆ</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mord mathrm">âˆ£</span><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></span>where <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Ï€</mi><mo>(</mo><mi>v</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\pi(v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">Ï€</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span></span> are the parents of <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">v</span></span></span></span></span> in <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">G</span></span></span></span></span>.</p><p>We define generative models as directed models in which all labels <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi><mo>âˆˆ</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">y \in Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mrel">âˆˆ</span><span class="mord mathit" style="margin-right:0.22222em;">Y</span></span></span></span></span> are parents of <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo>âˆˆ</mo><mi>X</mi></mrow><annotation encoding="application/x-tex">x\in X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="base textstyle uncramped"><span class="mord mathit">x</span><span class="mrel">âˆˆ</span><span class="mord mathit" style="margin-right:0.07847em;">X</span></span></span></span></span>. This name is due to the labels &quot;generating&quot; the output: the labels are the contingencies upon which the probability of the output depends.</p><p>When we describe the probability distribution <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><mi mathvariant="bold">y</mi><mi mathvariant="normal">âˆ£</mi><mi mathvariant="bold">x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">p( \mathbf y|\mathbf x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="mord mathrm">âˆ£</span><span class="mord mathbf">x</span><span class="mclose">)</span></span></span></span></span>, we speak of a discriminative model. Every generative model has a discriminative counterpart. In the words of <a class="inline-citation" href="#jordan2002discriminative">Ng &amp; Jordan (2002, pp. 841)</a>, we call these generative-discriminative pairs. Training a generative model to maximize <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><mi mathvariant="bold">y</mi><mi mathvariant="normal">âˆ£</mi><mi mathvariant="bold">x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">p(\mathbf y|\mathbf x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="mord mathrm">âˆ£</span><span class="mord mathbf">x</span><span class="mclose">)</span></span></span></span></span>  yields the same model as training its discriminative counterpart. Conversely, training a discriminative model to maximize the joint probability <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><mi mathvariant="bold">x</mi><mo separator="true">,</mo><mi mathvariant="bold">y</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">p(\mathbf x,\mathbf y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mpunct">,</span><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="mclose">)</span></span></span></span></span> (instead of <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><mi mathvariant="bold">y</mi><mi mathvariant="normal">âˆ£</mi><mi mathvariant="bold">x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">p(\mathbf y|\mathbf x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="mord mathrm">âˆ£</span><span class="mord mathbf">x</span><span class="mclose">)</span></span></span></span></span>) results in the same model as training the generative counterpart.</p><p>It turns out that when we model a conditional distribution, we have more parameter freedom for <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><mi mathvariant="bold">y</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">p(\mathbf y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="mclose">)</span></span></span></span></span>, because we are not interested in parameter values for <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><mi mathvariant="bold">x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">p( \mathbf x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mclose">)</span></span></span></span></span>. Modeling <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><mi mathvariant="bold">y</mi><mi mathvariant="normal">âˆ£</mi><mi mathvariant="bold">x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">p( \mathbf y|\mathbf x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="mord mathrm">âˆ£</span><span class="mord mathbf">x</span><span class="mclose">)</span></span></span></span></span>unburdens us with modeling the potentially very complicated inter-dependencies of <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><mi mathvariant="bold">x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">p(\mathbf x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mclose">)</span></span></span></span></span>. In classification tasks, this means that we are better able to use observations, and so discriminative models tend to out-perform generative models in practice. For a thorough explanation of the principle of generative-discriminative pairs, see <a class="inline-citation" href="#jordan2002discriminative">Ng &amp; Jordan (2002, pp. 841)</a>.</p><p>One generative-discriminative pair is formed by Hidden Markov Models (HMMs) and Linear Chain CRFs. In the following, we introduce HMMs (generative) to support a definition of Linear-Chain CRFs (discriminative).</p></div></section><section id="hmm"><h5 class="title"><a class="link-up" href="#"></a>Hidden Markov Models</h5><div><p>Hidden Markov Models (HMMs) are a subclass of graphical models in which we model a linear sequence of observations <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="bold">x</mi><mo>=</mo><mo>{</mo><msub><mi>x</mi><mi>t</mi></msub><msubsup><mo>}</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup></mrow><annotation encoding="application/x-tex">\mathbf x=\{x_t\}_{t=1}^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8413309999999999em;"></span><span class="strut bottom" style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathbf">x</span><span class="mrel">=</span><span class="mopen">{</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose"><span class="mclose">}</span><span class="vlist"><span style="top:0.24810799999999997em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span></span> that are assumed to be generated by a sequence of hidden states <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="bold">y</mi><mo>=</mo><mo>{</mo><msub><mi>y</mi><mi>t</mi></msub><msubsup><mo>}</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup></mrow><annotation encoding="application/x-tex">\mathbf y=\{y_t\}_{t=1}^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8413309999999999em;"></span><span class="strut bottom" style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="mrel">=</span><span class="mopen">{</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose"><span class="mclose">}</span><span class="vlist"><span style="top:0.24810799999999997em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span></span>. One example of an application would be spoken word recognition, in which samples of the sound waves can be seen as observations, and the actual phonemes as the hidden states.</p><p>To assure computational tractability, HMMs make use of the Markov assumption, which is that:</p><ol><li>any output variable (or <em>label</em>) <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">y_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span></span> only depends on <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">y_{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.638891em;vertical-align:-0.208331em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">âˆ’</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span></span>, where the initial probability <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><msub><mi>y</mi><mrow><mn>1</mn></mrow></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">p(y_{1})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span></span> is given</li><li>any input variable (or <em>observation</em>) <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">x_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span></span> only depends on the label <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">y_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span></span>; the observation <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">x_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span></span> is generated by label <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">y_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span></span>.</li></ol><p>A HMM is then a graphical model which factorizes as follows:<span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mrow><mo fence="true">(</mo><mi mathvariant="bold">x</mi><mo separator="true">,</mo><mi mathvariant="bold">y</mi><mo fence="true">)</mo></mrow><mo>=</mo><msubsup><mo>âˆ</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><mi>p</mi><mo>(</mo><msub><mi>x</mi><mi>t</mi></msub><mo>)</mo><mi>p</mi><mo>(</mo><msub><mi>y</mi><mi>t</mi></msub><mo>)</mo><mo>=</mo><msubsup><mo>âˆ</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><mi>p</mi><mo>(</mo><msub><mi>x</mi><mi>t</mi></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>y</mi><mi>t</mi></msub><mo>)</mo><mi>p</mi><mo>(</mo><msub><mi>y</mi><mi>t</mi></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>y</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">p\left ( \mathbf x, \mathbf y\right ) = \prod _{t=1}^T p(x_t)p(y_t) = \prod _{t=1}^T p(x_t|y_t)p(y_t|y_{t-1})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.8283360000000002em;"></span><span class="strut bottom" style="height:3.0954490000000003em;vertical-align:-1.267113em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit">p</span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">(</span><span class="mord mathbf">x</span><span class="mpunct">,</span><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">)</span></span><span class="mrel">=</span><span class="mop op-limits"><span class="vlist"><span style="top:1.1671129999999998em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.000005000000000143778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span><span class="op-symbol large-op mop">âˆ</span></span></span><span style="top:-1.2500050000000003em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mop op-limits"><span class="vlist"><span style="top:1.1671129999999998em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.000005000000000143778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span><span class="op-symbol large-op mop">âˆ</span></span></span><span style="top:-1.2500050000000003em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">âˆ’</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span></span></span></p><p>It can be shown that HMMs are generative models. If we return to the representation of HMMs in <a href="#fig-models-relationships">Figure 1</a>, we see that the white nodes represent labels and the grey nodes the observations. Typically, observations are given, but the labels need to be guessed. This is done by looping over all <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="bold">y</mi><mo>âˆˆ</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">\mathbf y\in Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="mrel">âˆˆ</span><span class="mord mathit" style="margin-right:0.22222em;">Y</span></span></span></span></span> and selecting <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi mathvariant="bold">y</mi><mo>âˆ—</mo></msup><mo>âˆˆ</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">\mathbf y^*\in Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.688696em;"></span><span class="strut bottom" style="height:0.8831359999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class=""><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord">âˆ—</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">âˆˆ</span><span class="mord mathit" style="margin-right:0.22222em;">Y</span></span></span></span></span> with the highest likelihood.</p><p>To find plausible values of <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><msub><mi>x</mi><mi>t</mi></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>y</mi><mi>t</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">p(x_t|y_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span></span> and <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><msub><mi>y</mi><mi>t</mi></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>y</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">p(y_t|y_{t-1})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">âˆ’</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span></span>, we typically use a set of known observation-label sequences with a parameter estimation method such as the <a class="wiki" href="https://en.wikipedia.org/wiki/Baum%E2%80%93Welch_algorithm">Baum-Welch algorithm</a>[TODO ref?].</p></div></section><section id="linear-chain-crf"><h5 class="title"><a class="link-up" href="#"></a>Linear Chain Conditional Random Fields</h5><div><p>On the surface, linear-chain CRFs (LC-CRFs) look much like Hidden Markov Models: as we see in <a href="#fig-models-relationships">Figure 1</a>, LC-CRFs also model a sequence of observations along a sequence of labels. The difference between HMMs and Linear Chain CRFs is that instead of modeling the joint probability <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><mi mathvariant="bold">x</mi><mo separator="true">,</mo><mi mathvariant="bold">y</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">p(\mathbf x,\mathbf y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mpunct">,</span><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="mclose">)</span></span></span></span></span>, we model the conditional probability <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><mi mathvariant="bold">y</mi><mi mathvariant="normal">âˆ£</mi><mi mathvariant="bold">x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">p(\mathbf y|\mathbf x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="mord mathrm">âˆ£</span><span class="mord mathbf">x</span><span class="mclose">)</span></span></span></span></span>.</p><p>This is a fundamental difference: we don&#x27;t assume that the labels generate observations, but rather that the observations provide support for the probability of labels.</p><p>We define a linear-chain conditional random field as follows:</p><p>Let</p><ul><li><span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Y</mi><mo separator="true">,</mo><mi>X</mi></mrow><annotation encoding="application/x-tex">Y,X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.22222em;">Y</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.07847em;">X</span></span></span></span></span> be random vectors taking valuations from <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="script">V</mi></mrow></mrow><annotation encoding="application/x-tex">\mathcal{V}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.08222em;">V</span></span></span></span></span></span></li><li><span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi><mo>=</mo><mo>{</mo><msub><mi mathvariant="normal">Î¦</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>â€¦</mo><msub><mi mathvariant="normal">Î¦</mi><mi>k</mi></msub><mo>}</mo></mrow><annotation encoding="application/x-tex">F=\{\Phi_1, \ldots\Phi_k\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">F</span><span class="mrel">=</span><span class="mopen">{</span><span class="mord"><span class="mord mathrm">Î¦</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="minner">â€¦</span><span class="mord"><span class="mord mathrm">Î¦</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">}</span></span></span></span></span> be a set of local functions <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>V</mi><mi>n</mi></msup><mo>â†’</mo><msup><mrow><mi mathvariant="double-struck">R</mi></mrow><mo>+</mo></msup></mrow><annotation encoding="application/x-tex">V^n\rightarrow \mathbb{R}^+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.771331em;"></span><span class="strut bottom" style="height:0.771331em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">â†’</span><span class=""><span class="mord textstyle uncramped"><span class="mord mathbb">R</span></span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord">+</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span></span></li></ul><p>Where each local function <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="normal">Î¦</mi><mrow><mi>k</mi><mo separator="true">,</mo><mi>t</mi></mrow></msub><mo>(</mo><mi mathvariant="bold">x</mi><mo separator="true">,</mo><mi mathvariant="bold">y</mi><mo>)</mo><mo>=</mo><msub><mi>Î»</mi><mrow><mi>k</mi></mrow></msub><msub><mi>f</mi><mrow><mi>k</mi></mrow></msub><mo>(</mo><msub><mi mathvariant="bold">y</mi><mrow><mi>t</mi></mrow></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">y</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">\Phi_{k,t}(\mathbf x,\mathbf y)=\lambda_{k} f_{k}(\mathbf y_{t},\mathbf y_{t-1},\mathbf x_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.052771em;vertical-align:-0.302771em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathrm">Î¦</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mpunct">,</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mpunct">,</span><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord"><span class="mord mathit">Î»</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class=""><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="vlist"><span style="top:0.24444em;margin-right:0.05em;margin-left:-0.01597em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class=""><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="vlist"><span style="top:0.24444000000000002em;margin-right:0.05em;margin-left:-0.01597em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">âˆ’</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class=""><span class="mord mathbf">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span></span> for some</p><ul><li><span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf x_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.59444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class=""><span class="mord mathbf">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span></span> and <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="bold">y</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf y_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.6888799999999999em;vertical-align:-0.24444em;"></span><span class="base textstyle uncramped"><span class=""><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="vlist"><span style="top:0.24444em;margin-right:0.05em;margin-left:-0.01597em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span></span> be elements of <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="bold">x</mi></mrow><annotation encoding="application/x-tex">\mathbf x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.44444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathbf">x</span></span></span></span></span> and <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="bold">y</mi></mrow><annotation encoding="application/x-tex">\mathbf y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.63888em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span></span></span> respectively, i.e., <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf x_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.59444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class=""><span class="mord mathbf">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span></span> is the current observation and <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="bold">y</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf y_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.6888799999999999em;vertical-align:-0.24444em;"></span><span class="base textstyle uncramped"><span class=""><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="vlist"><span style="top:0.24444em;margin-right:0.05em;margin-left:-0.01597em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span></span> is the current label, and <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">y_{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.638891em;vertical-align:-0.208331em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">âˆ’</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span></span> is the previous label.</li><li><span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="script">F</mi><mo>=</mo><mo>{</mo><msub><mi>f</mi><mi>k</mi></msub><mo>(</mo><mi>y</mi><mo separator="true">,</mo><msup><mi>y</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup><mo separator="true">,</mo><mi>x</mi><mo>)</mo><mo>}</mo></mrow><annotation encoding="application/x-tex">\mathcal F=\{f_k(y, y&#x27;, x)\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span><span class="mrel">=</span><span class="mopen">{</span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mclose">}</span></span></span></span></span> be a set of feature functions that give a real-valued score given a current label, the previous label and the current output token. These functions are defined by the CRF designer.</li><li><span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Î›</mi><mo>=</mo><mo>{</mo><msub><mi>Î»</mi><mi>k</mi></msub><mo>}</mo><mo>âˆˆ</mo><msup><mrow><mi mathvariant="double-struck">R</mi></mrow><mi>K</mi></msup></mrow><annotation encoding="application/x-tex">\Lambda=\{\lambda_k\} \in \mathbb{R}^K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8413309999999999em;"></span><span class="strut bottom" style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">Î›</span><span class="mrel">=</span><span class="mopen">{</span><span class="mord"><span class="mord mathit">Î»</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">}</span><span class="mrel">âˆˆ</span><span class=""><span class="mord textstyle uncramped"><span class="mord mathbb">R</span></span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">K</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span></span> be a vector of weight parameters that give a measure of how important a given feature function is. These parameters are found by training the CRF.</li></ul><p>We then define the un-normalized CRF distribution as:<span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mrow><mi>p</mi></mrow><mo>^</mo></mover><mo>(</mo><mi mathvariant="bold">x</mi><mo separator="true">,</mo><mi mathvariant="bold">y</mi><mo>)</mo><mo>=</mo><msubsup><mo>âˆ</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><msubsup><mo>âˆ</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></msubsup><msub><mi mathvariant="normal">Î¦</mi><mrow><mi>k</mi><mo separator="true">,</mo><mi>t</mi></mrow></msub><mo>(</mo><mi mathvariant="bold">x</mi><mo separator="true">,</mo><mi mathvariant="bold">y</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\hat{p}(\mathbf x, \mathbf y)=\prod_{t=1}^T\prod_{k=1}^K\Phi_{k,t}(\mathbf x, \mathbf y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.8283360000000002em;"></span><span class="strut bottom" style="height:3.1304490000000005em;vertical-align:-1.302113em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord displaystyle textstyle cramped"><span class="mord mathit">p</span></span></span><span style="top:0em;margin-left:0.16668em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="accent-body"><span>^</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mpunct">,</span><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="mclose">)</span><span class="mrel">=</span><span class="mop op-limits"><span class="vlist"><span style="top:1.1671129999999998em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.000005000000000143778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span><span class="op-symbol large-op mop">âˆ</span></span></span><span style="top:-1.2500050000000003em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mop op-limits"><span class="vlist"><span style="top:1.202113em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.000005000000000032756em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span><span class="op-symbol large-op mop">âˆ</span></span></span><span style="top:-1.250005em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">K</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathrm">Î¦</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mpunct">,</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mpunct">,</span><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="mclose">)</span></span></span></span></span></span></p><p>Recall from <a href="#graphical-models">our introduction on graphical models</a> that we need a normalizing constant to ensure that our probability distribution adds up to <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span></span></span></span></span>. We are interested in representing <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><mi mathvariant="bold">y</mi><mi mathvariant="normal">âˆ£</mi><mi mathvariant="bold">x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">p(\mathbf y|\mathbf x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="mord mathrm">âˆ£</span><span class="mord mathbf">x</span><span class="mclose">)</span></span></span></span></span>, so we use a normalization function that assumes <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="bold">x</mi></mrow><annotation encoding="application/x-tex">\mathbf x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.44444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathbf">x</span></span></span></span></span> is given and sums over every possible string of labels <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><annotation encoding="application/x-tex">\mathbf{y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.63888em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span></span></span></span>, i.e.:<span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Z</mi><mo>(</mo><mi mathvariant="bold">x</mi><mo>)</mo><mo>=</mo><msub><mo>âˆ‘</mo><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow></msub><mover accent="true"><mrow><mi>p</mi></mrow><mo>^</mo></mover><mo>(</mo><mi mathvariant="bold">x</mi><mo separator="true">,</mo><mi mathvariant="bold">y</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">Z(\mathbf x)=\sum_{\mathbf{y}}\hat{p}(\mathbf x, \mathbf y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.0500050000000003em;"></span><span class="strut bottom" style="height:2.4361180000000004em;vertical-align:-1.386113em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">Z</span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mclose">)</span><span class="mrel">=</span><span class="mop op-limits"><span class="vlist"><span style="top:1.150005em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span></span></span><span style="top:-0.000005000000000143778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span><span class="op-symbol large-op mop">âˆ‘</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord displaystyle textstyle cramped"><span class="mord mathit">p</span></span></span><span style="top:0em;margin-left:0.16668em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="accent-body"><span>^</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mpunct">,</span><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="mclose">)</span></span></span></span></span></span>and so<span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><mi mathvariant="bold">y</mi><mi mathvariant="normal">âˆ£</mi><mi mathvariant="bold">x</mi><mo>)</mo><mo>=</mo><mfrac><mrow><mn>1</mn></mrow><mrow><mi>Z</mi><mo>(</mo><mi mathvariant="bold">x</mi><mo>)</mo></mrow></mfrac><mover accent="true"><mrow><mi>p</mi></mrow><mo>^</mo></mover><mo>(</mo><mi mathvariant="bold">x</mi><mo separator="true">,</mo><mi mathvariant="bold">y</mi><mo>)</mo><mo>=</mo><mfrac><mrow><mn>1</mn></mrow><mrow><mi>Z</mi><mo>(</mo><mi mathvariant="bold">x</mi><mo>)</mo></mrow></mfrac><msubsup><mo>âˆ</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><msubsup><mo>âˆ</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>K</mi></mrow></msubsup><msub><mi>Î»</mi><mi>k</mi></msub><msub><mi>f</mi><mi>k</mi></msub><mo>(</mo><msub><mi mathvariant="bold">y</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">y</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">p(\mathbf y|\mathbf x)= \frac{1}{Z(\mathbf x)}\hat{p}(\mathbf x, \mathbf y) = \frac{1}{Z(\mathbf x)}\prod_{t=1}^T\prod_{k=1}^{K} \lambda_k f_k(\mathbf y_t, \mathbf y_{t-1}, \mathbf x_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.8283360000000002em;"></span><span class="strut bottom" style="height:3.1304490000000005em;vertical-align:-1.302113em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="mord mathrm">âˆ£</span><span class="mord mathbf">x</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit" style="margin-right:0.07153em;">Z</span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mclose">)</span></span></span></span><span style="top:-0.2300000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="mord displaystyle textstyle cramped"><span class="mord mathit">p</span></span></span><span style="top:0em;margin-left:0.16668em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="accent-body"><span>^</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mpunct">,</span><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit" style="margin-right:0.07153em;">Z</span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mclose">)</span></span></span></span><span style="top:-0.2300000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mop op-limits"><span class="vlist"><span style="top:1.1671129999999998em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.000005000000000143778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span><span class="op-symbol large-op mop">âˆ</span></span></span><span style="top:-1.2500050000000003em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mop op-limits"><span class="vlist"><span style="top:1.202113em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.000005000000000032756em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span><span class="op-symbol large-op mop">âˆ</span></span></span><span style="top:-1.250005em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">K</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit">Î»</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class=""><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="vlist"><span style="top:0.24444em;margin-right:0.05em;margin-left:-0.01597em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class=""><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="vlist"><span style="top:0.24444000000000002em;margin-right:0.05em;margin-left:-0.01597em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">âˆ’</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class=""><span class="mord mathbf">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span></span></span></p><p>When we recall that the product of exponents equals the logarithm of their sum, we can re-write <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><mi mathvariant="bold">y</mi><mi mathvariant="normal">âˆ£</mi><mi mathvariant="bold">x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">p(\mathbf y|\mathbf x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="mord mathrm">âˆ£</span><span class="mord mathbf">x</span><span class="mclose">)</span></span></span></span></span> as</p><span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><mi mathvariant="bold">y</mi><mi mathvariant="normal">âˆ£</mi><mi mathvariant="bold">x</mi><mo>)</mo><mo>=</mo><mfrac><mrow><mi>exp</mi><mrow><mo fence="true">{</mo><msubsup><mo>âˆ‘</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><msubsup><mo>âˆ‘</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>K</mi></mrow></msubsup><msub><mi>Î»</mi><mi>k</mi></msub><msub><mi>f</mi><mi>k</mi></msub><mo>(</mo><msub><mi mathvariant="bold">y</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">y</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo>)</mo><mo fence="true">}</mo></mrow></mrow><mrow><msub><mo>âˆ‘</mo><mrow><msup><mi mathvariant="bold">y</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mi>exp</mi><mrow><mo fence="true">{</mo><msubsup><mo>âˆ‘</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><msubsup><mo>âˆ‘</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>K</mi></mrow></msubsup><msub><mi>Î»</mi><mi>k</mi></msub><msub><mi>f</mi><mi>k</mi></msub><mo>(</mo><msubsup><mi mathvariant="bold">y</mi><mrow><mi>t</mi></mrow><mrow><mi mathvariant="normal">â€²</mi></mrow></msubsup><mo separator="true">,</mo><msubsup><mi>y</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow><mrow><mi mathvariant="normal">â€²</mi></mrow></msubsup><mo separator="true">,</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo>)</mo><mo fence="true">}</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">p(\mathbf y|\mathbf x) = \frac{\exp\left \{\sum_{t=1}^T\sum_{k=1}^{K} \lambda_k f_k(\mathbf y_t, \mathbf y_{t-1}, \mathbf x_t)\right \}}{\sum_{\mathbf y&#x27;}\exp\left \{\sum_{t=1}^T\sum_{k=1}^{K} \lambda_k f_k(\mathbf y_{t}&#x27;, y&#x27;_{t-1}, \mathbf x_t)\right \}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.59001em;"></span><span class="strut bottom" style="height:2.766128em;vertical-align:-1.176118em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="mord mathrm">âˆ£</span><span class="mord mathbf">x</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.74em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mop"><span class="op-symbol small-op mop" style="top:-0.0000050000000000050004em;">âˆ‘</span><span class="vlist"><span style="top:0.30001em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class=""><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mop">exp</span><span class="minner textstyle cramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">{</span></span><span class="mop"><span class="op-symbol small-op mop" style="top:-0.0000050000000000050004em;">âˆ‘</span><span class="vlist"><span style="top:0.30001em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.364em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mop"><span class="op-symbol small-op mop" style="top:-0.0000050000000000050004em;">âˆ‘</span><span class="vlist"><span style="top:0.30001em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.364em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.07153em;">K</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit">Î»</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class=""><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="vlist"><span style="top:0.24575599999999992em;margin-left:-0.01597em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span style="top:-0.34479999999999994em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.2663079999999999em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">âˆ’</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.3448em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class=""><span class="mord mathbf">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">}</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.7400100000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mop">exp</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">{</span></span><span class="mop"><span class="op-symbol small-op mop" style="top:-0.0000050000000000050004em;">âˆ‘</span><span class="vlist"><span style="top:0.30001em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.364em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mop"><span class="op-symbol small-op mop" style="top:-0.0000050000000000050004em;">âˆ‘</span><span class="vlist"><span style="top:0.30001em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.364em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">K</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit">Î»</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class=""><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="vlist"><span style="top:0.24444em;margin-right:0.05em;margin-left:-0.01597em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class=""><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="vlist"><span style="top:0.24444000000000002em;margin-right:0.05em;margin-left:-0.01597em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">âˆ’</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class=""><span class="mord mathbf">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">}</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span></span><p>This is the canonical form of Conditional Random Fields.</p><p><a class="inline-citation" href="#sutton2006introduction">McCallum &amp; Sutton (2006, pp. 93â€”128)</a> show that a logistic regression model is a simple CRF, and also that rewriting the probability distribution <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><mi mathvariant="bold">x</mi><mo separator="true">,</mo><mi mathvariant="bold">y</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">p(\mathbf x,\mathbf y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mpunct">,</span><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="mclose">)</span></span></span></span></span> of a HMM yields a Conditional Random Field with a particular choice of feature functions.</p></div></section><section id="crf-parameter-estimation"><h5 class="title"><a class="link-up" href="#"></a>Parameter Estimation</h5><div><p>As we saw in the previous section, we obtain parameters <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Î›</mi></mrow><annotation encoding="application/x-tex">\Lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">Î›</span></span></span></span></span> by training our CRF on a pre-labeled training set of pairs <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="script">D</mi><mo>=</mo><mo>{</mo><msup><mrow><mi mathvariant="bold">x</mi></mrow><mrow><mi>i</mi></mrow></msup><mo separator="true">,</mo><msup><mrow><mi mathvariant="bold">y</mi></mrow><mrow><mi>i</mi></mrow></msup><msubsup><mo>}</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup></mrow><annotation encoding="application/x-tex">\mathcal D=\{\mathbf{x}^{i},\mathbf{y}^{i}\}_{i=1}^N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8413309999999999em;"></span><span class="strut bottom" style="height:1.0999949999999998em;vertical-align:-0.258664em;"></span><span class="base textstyle uncramped"><span class="mord mathcal" style="margin-right:0.02778em;">D</span><span class="mrel">=</span><span class="mopen">{</span><span class=""><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class=""><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose"><span class="mclose">}</span><span class="vlist"><span style="top:0.258664em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span></span> where each <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.65952em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">i</span></span></span></span></span> indexes an example instance: <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mi mathvariant="bold">x</mi></mrow><mrow><mi>i</mi></mrow></msup><mo>=</mo><mo>{</mo><msubsup><mi>x</mi><mn>1</mn><mrow><mi>i</mi></mrow></msubsup><mo separator="true">,</mo><msubsup><mi>x</mi><mn>2</mn><mrow><mi>i</mi></mrow></msubsup><mo separator="true">,</mo><mo>â‹¯</mo><mo separator="true">,</mo><msubsup><mi>x</mi><mi>T</mi><mrow><mi>i</mi></mrow></msubsup><mo>}</mo></mrow><annotation encoding="application/x-tex">\mathbf{x}^{i}=\{x^{i}_1, x^{i}_2, \cdots, x^{i}_T\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.824664em;"></span><span class="strut bottom" style="height:1.0999949999999998em;vertical-align:-0.275331em;"></span><span class="base textstyle uncramped"><span class=""><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mopen">{</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.24810799999999997em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.24810799999999997em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="minner">â‹¯</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.275331em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">}</span></span></span></span></span> is a set of input tokens, and <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mi mathvariant="bold">y</mi></mrow><mrow><mi>i</mi></mrow></msup><mo>=</mo><mo>{</mo><msubsup><mi>y</mi><mn>1</mn><mrow><mi>i</mi></mrow></msubsup><mo separator="true">,</mo><msubsup><mi>y</mi><mn>2</mn><mrow><mi>i</mi></mrow></msubsup><mo separator="true">,</mo><mo>â‹¯</mo><mo separator="true">,</mo><msubsup><mi>y</mi><mi>T</mi><mrow><mi>i</mi></mrow></msubsup><mo>}</mo></mrow><annotation encoding="application/x-tex">\mathbf{y}^{i}=\{y^{i}_1, y^{i}_2, \cdots, y^{i}_T\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.824664em;"></span><span class="strut bottom" style="height:1.0999949999999998em;vertical-align:-0.275331em;"></span><span class="base textstyle uncramped"><span class=""><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mopen">{</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.24810799999999997em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.24810799999999997em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="minner">â‹¯</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.275331em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">}</span></span></span></span></span> is a set of output tags for instance length <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span></span></span>.</p><p>The training process will maximize some likelihood function <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">â„“</mi><mo>(</mo><mi mathvariant="normal">Î›</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\ell(\Lambda)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">â„“</span><span class="mopen">(</span><span class="mord mathrm">Î›</span><span class="mclose">)</span></span></span></span></span>. We are modeling a conditional distribution, so it makes sense to use the conditional log likelihood function:</p><span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">â„“</mi><mo>(</mo><mi mathvariant="normal">Î›</mi><mo>)</mo><mo>=</mo><msubsup><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mi>log</mi><mrow><mi>p</mi><mo>(</mo><msup><mi mathvariant="bold">y</mi><mrow><mi>i</mi></mrow></msup><mi mathvariant="normal">âˆ£</mi><msup><mi mathvariant="bold">x</mi><mrow><mi>i</mi></mrow></msup></mrow><mo>)</mo></mrow><annotation encoding="application/x-tex">\ell(\Lambda)=\sum_{i=1}^N \log{p(\mathbf y^{i}|\mathbf x^{i}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.8283360000000002em;"></span><span class="strut bottom" style="height:3.106005em;vertical-align:-1.277669em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathrm">â„“</span><span class="mopen">(</span><span class="mord mathrm">Î›</span><span class="mclose">)</span><span class="mrel">=</span><span class="mop op-limits"><span class="vlist"><span style="top:1.1776689999999999em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.000005000000000143778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span><span class="op-symbol large-op mop">âˆ‘</span></span></span><span style="top:-1.2500050000000003em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class=""><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class=""><span class="mord mathbf">x</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span><span class="mclose">)</span></span></span></span></span></span><p>Where <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span></span></span></span></span> is the CRF distribution as we saw in the previous section:</p><span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">â„“</mi><mo>(</mo><mi mathvariant="normal">Î›</mi><mo>)</mo><mo>=</mo><msubsup><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mi>log</mi><mrow><mfrac><mrow><mi>exp</mi><mrow><mo fence="true">{</mo><msubsup><mo>âˆ‘</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><msubsup><mo>âˆ‘</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>K</mi></mrow></msubsup><msub><mi>Î»</mi><mi>k</mi></msub><msub><mi>f</mi><mi>k</mi></msub><mo>(</mo><msubsup><mi mathvariant="bold">y</mi><mi>t</mi><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi mathvariant="bold">y</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi mathvariant="bold">x</mi><mi>t</mi><mi>i</mi></msubsup><mo>)</mo><mo fence="true">}</mo></mrow></mrow><mrow><msub><mo>âˆ‘</mo><mrow><msup><mi mathvariant="bold">y</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><mi>exp</mi><mrow><mo fence="true">{</mo><msubsup><mo>âˆ‘</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><msubsup><mo>âˆ‘</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>K</mi></mrow></msubsup><msub><mi>Î»</mi><mi>k</mi></msub><msub><mi>f</mi><mi>k</mi></msub><mo>(</mo><msubsup><mi mathvariant="bold">y</mi><mrow><mi>t</mi></mrow><mrow><mi mathvariant="normal">â€²</mi></mrow></msubsup><mo separator="true">,</mo><msubsup><mi>y</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow><mrow><mi mathvariant="normal">â€²</mi></mrow></msubsup><mo separator="true">,</mo><msubsup><mi mathvariant="bold">x</mi><mi>t</mi><mi>i</mi></msubsup><mo>)</mo><mo fence="true">}</mo></mrow></mrow></mfrac></mrow></mrow><annotation encoding="application/x-tex">\ell(\Lambda) = \sum_{i=1}^N\log{\frac{\exp\left \{\sum_{t=1}^T\sum_{k=1}^{K} \lambda_k f_k(\mathbf y^i_t, \mathbf y^i_{t-1}, \mathbf x^i_t)\right \}}{\sum_{\mathbf y&#x27;}\exp\left \{\sum_{t=1}^T\sum_{k=1}^{K} \lambda_k f_k(\mathbf y^i_{t}&#x27;, y&#x27;_{t-1}, \mathbf x^i_t)\right \}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.8283360000000002em;"></span><span class="strut bottom" style="height:3.106005em;vertical-align:-1.277669em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathrm">â„“</span><span class="mopen">(</span><span class="mord mathrm">Î›</span><span class="mclose">)</span><span class="mrel">=</span><span class="mop op-limits"><span class="vlist"><span style="top:1.1776689999999999em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.000005000000000143778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span><span class="op-symbol large-op mop">âˆ‘</span></span></span><span style="top:-1.2500050000000003em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.74em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mop"><span class="op-symbol small-op mop" style="top:-0.0000050000000000050004em;">âˆ‘</span><span class="vlist"><span style="top:0.30001em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class=""><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mop">exp</span><span class="minner textstyle cramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">{</span></span><span class="mop"><span class="op-symbol small-op mop" style="top:-0.0000050000000000050004em;">âˆ‘</span><span class="vlist"><span style="top:0.30001em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.364em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mop"><span class="op-symbol small-op mop" style="top:-0.0000050000000000050004em;">âˆ‘</span><span class="vlist"><span style="top:0.30001em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.364em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.07153em;">K</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit">Î»</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class=""><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="vlist"><span style="top:0.24575599999999992em;margin-left:-0.01597em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span></span></span></span><span style="top:-0.34479999999999994em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.2663079999999999em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">âˆ’</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.3448em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class=""><span class="mord mathbf">x</span><span class="vlist"><span style="top:0.24575599999999992em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.34479999999999994em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">}</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.7400100000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mop">exp</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">{</span></span><span class="mop"><span class="op-symbol small-op mop" style="top:-0.0000050000000000050004em;">âˆ‘</span><span class="vlist"><span style="top:0.30001em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.364em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mop"><span class="op-symbol small-op mop" style="top:-0.0000050000000000050004em;">âˆ‘</span><span class="vlist"><span style="top:0.30001em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.364em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">K</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit">Î»</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class=""><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="vlist"><span style="top:0.247em;margin-left:-0.01597em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class=""><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="vlist"><span style="top:0.24810799999999997em;margin-left:-0.01597em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">âˆ’</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.36299999999999993em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class=""><span class="mord mathbf">x</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size1">}</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span></span></span><p>Simplifying, we have:</p><span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">â„“</mi><mo>(</mo><mi mathvariant="normal">Î›</mi><mo>)</mo><mo>=</mo><msubsup><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><msubsup><mo>âˆ‘</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><msubsup><mo>âˆ‘</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></msubsup><msub><mi>Î»</mi><mi>k</mi></msub><msub><mi>f</mi><mi>k</mi></msub><mo>(</mo><msubsup><mi>y</mi><mi>t</mi><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi>y</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi mathvariant="bold">x</mi><mi>t</mi><mi>i</mi></msubsup><mo>)</mo><mo>âˆ’</mo><msubsup><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mi>log</mi><mrow><mi>Z</mi><mo>(</mo><msup><mi mathvariant="bold">x</mi><mi>i</mi></msup></mrow><mo>)</mo></mrow><annotation encoding="application/x-tex">\ell(\Lambda) = \sum_{i=1}^N\sum_{t=1}^T\sum_{k=1}^K \lambda_kf_k(y^i_t,y^i_{t-1},\mathbf x^i_t)-\sum_{i=1}^N\log{Z(\mathbf x^i})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.8283360000000002em;"></span><span class="strut bottom" style="height:3.1304490000000005em;vertical-align:-1.302113em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathrm">â„“</span><span class="mopen">(</span><span class="mord mathrm">Î›</span><span class="mclose">)</span><span class="mrel">=</span><span class="mop op-limits"><span class="vlist"><span style="top:1.1776689999999999em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.000005000000000143778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span><span class="op-symbol large-op mop">âˆ‘</span></span></span><span style="top:-1.2500050000000003em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mop op-limits"><span class="vlist"><span style="top:1.1671129999999998em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.000005000000000143778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span><span class="op-symbol large-op mop">âˆ‘</span></span></span><span style="top:-1.2500050000000003em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mop op-limits"><span class="vlist"><span style="top:1.202113em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.000005000000000032756em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span><span class="op-symbol large-op mop">âˆ‘</span></span></span><span style="top:-1.250005em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">K</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit">Î»</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.247em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.24700000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">âˆ’</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class=""><span class="mord mathbf">x</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mbin">âˆ’</span><span class="mop op-limits"><span class="vlist"><span style="top:1.1776689999999999em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.000005000000000143778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span><span class="op-symbol large-op mop">âˆ‘</span></span></span><span style="top:-1.2500050000000003em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">Z</span><span class="mopen">(</span><span class=""><span class="mord mathbf">x</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span><span class="mclose">)</span></span></span></span></span></span><p>We also add a penalty term to the likelihood function to avoid overfitting. This is called regularization, and in this particular instance we use L2 regularization:</p><span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">â„“</mi><mo>(</mo><mi mathvariant="normal">Î›</mi><mo>)</mo><mo>=</mo><msubsup><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><msubsup><mo>âˆ‘</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><msubsup><mo>âˆ‘</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></msubsup><msub><mi>Î»</mi><mi>k</mi></msub><msub><mi>f</mi><mi>k</mi></msub><mo>(</mo><msubsup><mi>y</mi><mi>t</mi><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi>y</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi mathvariant="bold">x</mi><mi>t</mi><mi>i</mi></msubsup><mo>)</mo><mo>âˆ’</mo><msubsup><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><mi>log</mi><mrow><mi>Z</mi><mo>(</mo><msup><mi mathvariant="bold">x</mi><mi>i</mi></msup><mo>)</mo></mrow><mo>âˆ’</mo><msubsup><mo>âˆ‘</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></msubsup><mfrac><mrow><msubsup><mi>Î»</mi><mrow><mi>k</mi></mrow><mn>2</mn></msubsup></mrow><mrow><mn>2</mn><msup><mi>Ïƒ</mi><mn>2</mn></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">\ell(\Lambda) = \sum_{i=1}^N\sum_{t=1}^T\sum_{k=1}^K \lambda_kf_k(y^i_t,y^i_{t-1},\mathbf x^i_t)-\sum_{i=1}^N\log{Z(\mathbf x^i)} - \sum_{k=1}^K\frac{\lambda_{k}^2}{2\sigma^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.8283360000000002em;"></span><span class="strut bottom" style="height:3.1304490000000005em;vertical-align:-1.302113em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathrm">â„“</span><span class="mopen">(</span><span class="mord mathrm">Î›</span><span class="mclose">)</span><span class="mrel">=</span><span class="mop op-limits"><span class="vlist"><span style="top:1.1776689999999999em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.000005000000000143778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span><span class="op-symbol large-op mop">âˆ‘</span></span></span><span style="top:-1.2500050000000003em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mop op-limits"><span class="vlist"><span style="top:1.1671129999999998em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.000005000000000143778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span><span class="op-symbol large-op mop">âˆ‘</span></span></span><span style="top:-1.2500050000000003em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mop op-limits"><span class="vlist"><span style="top:1.202113em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.000005000000000032756em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span><span class="op-symbol large-op mop">âˆ‘</span></span></span><span style="top:-1.250005em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">K</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit">Î»</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.247em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.24700000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">âˆ’</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class=""><span class="mord mathbf">x</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mbin">âˆ’</span><span class="mop op-limits"><span class="vlist"><span style="top:1.1776689999999999em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.000005000000000143778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span><span class="op-symbol large-op mop">âˆ‘</span></span></span><span style="top:-1.2500050000000003em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">Z</span><span class="mopen">(</span><span class=""><span class="mord mathbf">x</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span><span class="mbin">âˆ’</span><span class="mop op-limits"><span class="vlist"><span style="top:1.202113em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.000005000000000032756em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span><span class="op-symbol large-op mop">âˆ‘</span></span></span><span style="top:-1.250005em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">K</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">2</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">Ïƒ</span><span class="vlist"><span style="top:-0.289em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit">Î»</span><span class="vlist"><span style="top:0.2831079999999999em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span></span><p>Because it is generally intractable to find the exact parameters <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Î›</mi></mrow><annotation encoding="application/x-tex">\Lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">Î›</span></span></span></span></span> that maximize the likelihood function <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">â„“</mi></mrow><annotation encoding="application/x-tex">\ell</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">â„“</span></span></span></span></span>, we use a hill-climbing algorithm. The general idea of hill-climbing algorithms is that we start out with some random assignment to the parameters <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Î›</mi></mrow><annotation encoding="application/x-tex">\Lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">Î›</span></span></span></span></span>, and estimate the parameters that maximize <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">â„“</mi></mrow><annotation encoding="application/x-tex">\ell</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">â„“</span></span></span></span></span> by iteratively moving along the gradient toward the global maximum. We find the direction to move in by taking the derivative of <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">â„“</mi></mrow><annotation encoding="application/x-tex">\ell</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">â„“</span></span></span></span></span> with respect to <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Î›</mi></mrow><annotation encoding="application/x-tex">\Lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">Î›</span></span></span></span></span>:</p><span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">âˆ‚</mi><mi mathvariant="normal">â„“</mi></mrow><mrow><mi mathvariant="normal">âˆ‚</mi><msub><mi>Î»</mi><mi>k</mi></msub></mrow></mfrac><mo>=</mo><msubsup><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><msubsup><mo>âˆ‘</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><msub><mi>f</mi><mi>k</mi></msub><mo>(</mo><msubsup><mi>y</mi><mi>t</mi><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi>y</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mo separator="true">,</mo><msubsup><mi>x</mi><mi>t</mi><mi>i</mi></msubsup><mo>)</mo><mo>âˆ’</mo><msubsup><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><msubsup><mo>âˆ‘</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><msub><mo>âˆ‘</mo><mrow><mi>y</mi><mo separator="true">,</mo><msup><mi>y</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup></mrow></msub><msub><mi>f</mi><mi>k</mi></msub><mo>(</mo><mi>y</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><msubsup><mi mathvariant="bold">x</mi><mi>t</mi><mi>i</mi></msubsup><mo>)</mo><mi>p</mi><mo>(</mo><mi>y</mi><mo separator="true">,</mo><msup><mi>y</mi><mrow><mi mathvariant="normal">â€²</mi></mrow></msup><mi mathvariant="normal">âˆ£</mi><msup><mi mathvariant="bold">x</mi><mi>i</mi></msup><mo>)</mo><mo>âˆ’</mo><msubsup><mo>âˆ‘</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></msubsup><mfrac><mrow><msub><mi>Î»</mi><mi>k</mi></msub></mrow><mrow><msup><mi>Ïƒ</mi><mn>2</mn></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{\partial\ell}{\partial\lambda_k} = \sum_{i=1}^N\sum_{t=1}^Tf_k(y_t^i,y_{t-1}^i,x_t^i) -\sum_{i=1}^N\sum_{t=1}^T\sum_{y,y&#x27;}f_k(y,y,\mathbf x_t^i) p(y,y&#x27;|\mathbf x^i)-\sum_{k=1}^K\frac{\lambda_k}{\sigma^2} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.8283360000000002em;"></span><span class="strut bottom" style="height:3.260529em;vertical-align:-1.432193em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">âˆ‚</span><span class="mord"><span class="mord mathit">Î»</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">âˆ‚</span><span class="mord mathrm">â„“</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mrel">=</span><span class="mop op-limits"><span class="vlist"><span style="top:1.1776689999999999em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.000005000000000143778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span><span class="op-symbol large-op mop">âˆ‘</span></span></span><span style="top:-1.2500050000000003em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mop op-limits"><span class="vlist"><span style="top:1.1671129999999998em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.000005000000000143778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span><span class="op-symbol large-op mop">âˆ‘</span></span></span><span style="top:-1.2500050000000003em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.247em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.24700000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">âˆ’</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mbin">âˆ’</span><span class="mop op-limits"><span class="vlist"><span style="top:1.1776689999999999em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">i</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.000005000000000143778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span><span class="op-symbol large-op mop">âˆ‘</span></span></span><span style="top:-1.2500050000000003em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mop op-limits"><span class="vlist"><span style="top:1.1671129999999998em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.000005000000000143778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span><span class="op-symbol large-op mop">âˆ‘</span></span></span><span style="top:-1.2500050000000003em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mop op-limits"><span class="vlist"><span style="top:1.196085em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:-0.289em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-scriptstyle scriptscriptstyle cramped"><span class="mord scriptscriptstyle cramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span style="top:-0.000005000000000032756em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span><span class="op-symbol large-op mop">âˆ‘</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class=""><span class="mord mathbf">x</span><span class="vlist"><span style="top:0.247em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">â€²</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class=""><span class="mord mathbf">x</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mbin">âˆ’</span><span class="mop op-limits"><span class="vlist"><span style="top:1.202113em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.000005000000000032756em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span><span class="op-symbol large-op mop">âˆ‘</span></span></span><span style="top:-1.250005em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">K</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">Ïƒ</span><span class="vlist"><span style="top:-0.289em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit">Î»</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span></span><p>And then update parameter <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Î»</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\lambda_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">Î»</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span></span> along this gradient:</p><span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>Î»</mi><mi>i</mi></msub><mo>:</mo><mo>=</mo><msub><mi>Î»</mi><mi>i</mi></msub><mo>+</mo><mi>Î±</mi><mfrac><mrow><mi mathvariant="normal">âˆ‚</mi><mi mathvariant="normal">â„“</mi></mrow><mrow><mi mathvariant="normal">âˆ‚</mi><msub><mi>Î»</mi><mi>k</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\lambda_i := \lambda_i + \alpha \frac{\partial\ell}{\partial\lambda_k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.37144em;"></span><span class="strut bottom" style="height:2.20744em;vertical-align:-0.8360000000000001em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">Î»</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">:</span><span class="mrel">=</span><span class="mord"><span class="mord mathit">Î»</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.0037em;">Î±</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">âˆ‚</span><span class="mord"><span class="mord mathit">Î»</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">âˆ‚</span><span class="mord mathrm">â„“</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span></span><p>Where <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Î±</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.0037em;">Î±</span></span></span></span></span> is some learning rate between <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">0</span></span></span></span></span> and <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span></span></span></span></span>.</p><p>Thanks to the fact that the distribution <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><msup><mrow><mi mathvariant="bold">y</mi></mrow><mrow><mi>i</mi></mrow></msup><mi mathvariant="normal">âˆ£</mi><msup><mrow><mi mathvariant="bold">x</mi></mrow><mrow><mi>i</mi></mrow></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">p(\mathbf{y}^{i}|\mathbf{x}^{i})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.824664em;"></span><span class="strut bottom" style="height:1.0746639999999998em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class=""><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathrm">âˆ£</span><span class=""><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span></span> is concave, the function <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">â„“</mi><mo>(</mo><mi mathvariant="normal">Î›</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\ell(\Lambda)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">â„“</span><span class="mopen">(</span><span class="mord mathrm">Î›</span><span class="mclose">)</span></span></span></span></span> is also concave. This ensures that any local optimum will be a global optimum. The regularization term also ensures any global optimum is a unique optimum, in addition to avoid overfitting.</p><p>In our experiment, we use the <a href="https://en.wikipedia.org/wiki/Limited-memory_BFGS">Limited-memory Broydenâ€“Fletcherâ€“Goldfarbâ€“Shanno algorithm (LM-BVFGS)</a>, which approximates Newton&#x27;s Method. This algorithm is optimized for the memory-contrained conditions in real-world computers, and also converges much faster than is naive implementation, because it works on the double derivative of <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">â„“</mi></mrow><annotation encoding="application/x-tex">\ell</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">â„“</span></span></span></span></span>.</p></div></section><section id="crf-inference"><h5 class="title"><a class="link-up" href="#"></a>Inference</h5><div><p>Given a trained CRF and an observation vector <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="bold">x</mi></mrow><annotation encoding="application/x-tex">\mathbf x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.44444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathbf">x</span></span></span></span></span>, we wish to compute the most likely label sequence <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="bold">y</mi></mrow><annotation encoding="application/x-tex">\mathbf y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.63888em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span></span></span>, i.e. <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="bold">y</mi></mrow><annotation encoding="application/x-tex">\mathbf y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.63888em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span></span></span> such that <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi mathvariant="bold">y</mi><mo>âˆ—</mo></msup><mo>=</mo><msub><mtext><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mtext><mrow><mi mathvariant="bold">y</mi></mrow></msub><mi>p</mi><mo>(</mo><mi mathvariant="bold">y</mi><mi mathvariant="normal">âˆ£</mi><mi mathvariant="bold">x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\mathbf y^*=\text{argmax}_{\mathbf y}p(\mathbf y|\mathbf x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.130548em;vertical-align:-0.380548em;"></span><span class="base textstyle uncramped"><span class=""><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord">âˆ—</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord"><span class="text mord textstyle uncramped"><span class="mord mathrm">a</span><span class="mord mathrm">r</span><span class="mord mathrm" style="margin-right:0.01389em;">g</span><span class="mord mathrm">m</span><span class="mord mathrm">a</span><span class="mord mathrm">x</span></span><span class="vlist"><span style="top:0.24444000000000002em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="mord mathrm">âˆ£</span><span class="mord mathbf">x</span><span class="mclose">)</span></span></span></span></span>. This path is known as the Viterbi sequence. Thanks to the structure of linear-chain CRFs, we can be efficiently compute the Viterbi sequence through a dynamic programming algorithm called the Viterbi algorithm, which is very similar to the forward-backward algorithm.</p><p>Substituting the canonical CRF representation of <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><mi mathvariant="bold">y</mi><mi mathvariant="normal">âˆ£</mi><mi mathvariant="bold">x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">p(\mathbf y|\mathbf x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="mord mathrm">âˆ£</span><span class="mord mathbf">x</span><span class="mclose">)</span></span></span></span></span>, we get:</p><span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi mathvariant="bold">y</mi><mo>âˆ—</mo></msup><mo>=</mo><msub><mtext><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mtext><mrow><mi mathvariant="bold">y</mi></mrow></msub><mfrac><mrow><mn>1</mn></mrow><mrow><mi>Z</mi><mo>(</mo><mi mathvariant="bold">x</mi><mo>)</mo></mrow></mfrac><mi>exp</mi><mrow><mo fence="true">{</mo><msubsup><mo>âˆ‘</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><msubsup><mo>âˆ‘</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>K</mi></mrow></msubsup><msub><mi>Î»</mi><mi>k</mi></msub><msub><mi>f</mi><mi>k</mi></msub><mo>(</mo><msub><mi>y</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>y</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo>)</mo><mo fence="true">}</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf y^*=\text{argmax}_{\mathbf y}\frac{1}{Z(\mathbf x)}\exp\left \{\sum_{t=1}^T\sum_{k=1}^{K} \lambda_k f_k(y_t, y_{t-1},\mathbf x_t)\right \}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.8283360000000002em;"></span><span class="strut bottom" style="height:3.1304490000000005em;vertical-align:-1.302113em;"></span><span class="base displaystyle textstyle uncramped"><span class=""><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord">âˆ—</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord"><span class="text mord displaystyle textstyle uncramped"><span class="mord mathrm">a</span><span class="mord mathrm">r</span><span class="mord mathrm" style="margin-right:0.01389em;">g</span><span class="mord mathrm">m</span><span class="mord mathrm">a</span><span class="mord mathrm">x</span></span><span class="vlist"><span style="top:0.24444000000000002em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit" style="margin-right:0.07153em;">Z</span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mclose">)</span></span></span></span><span style="top:-0.2300000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mop">exp</span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mop op-limits"><span class="vlist"><span style="top:1.1671129999999998em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.000005000000000143778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span><span class="op-symbol large-op mop">âˆ‘</span></span></span><span style="top:-1.2500050000000003em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mop op-limits"><span class="vlist"><span style="top:1.202113em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.000005000000000032756em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span><span class="op-symbol large-op mop">âˆ‘</span></span></span><span style="top:-1.250005em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">K</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit">Î»</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">âˆ’</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class=""><span class="mord mathbf">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size4">}</span></span></span></span></span></span></span></span><p>We can leave out the normalization factor <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mn>1</mn></mrow><mrow><mi>Z</mi><mo>(</mo><mi mathvariant="bold">x</mi><mo>)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{1}{Z(\mathbf x)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.845108em;"></span><span class="strut bottom" style="height:1.365108em;vertical-align:-0.52em;"></span><span class="base textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.34500000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.07153em;">Z</span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mclose">)</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span>, because the <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtext><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mtext></mrow><annotation encoding="application/x-tex">\text{argmax}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="text mord textstyle uncramped"><span class="mord mathrm">a</span><span class="mord mathrm">r</span><span class="mord mathrm" style="margin-right:0.01389em;">g</span><span class="mord mathrm">m</span><span class="mord mathrm">a</span><span class="mord mathrm">x</span></span></span></span></span></span> will be the same with or without:</p><span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi mathvariant="bold">y</mi><mo>âˆ—</mo></msup><mo>=</mo><msub><mtext><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">x</mi></mtext><mrow><mi mathvariant="bold">y</mi></mrow></msub><mi>exp</mi><mrow><mo fence="true">{</mo><msubsup><mo>âˆ‘</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><msubsup><mo>âˆ‘</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>K</mi></mrow></msubsup><msub><mi>Î»</mi><mi>k</mi></msub><msub><mi>f</mi><mi>k</mi></msub><mo>(</mo><msub><mi>y</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>y</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">x</mi><mi>t</mi></msub><mo>)</mo><mo fence="true">}</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf y^*=\text{argmax}_{\mathbf y}\exp\left \{\sum_{t=1}^T\sum_{k=1}^{K} \lambda_k f_k(y_t, y_{t-1},\mathbf x_t)\right \}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.8283360000000002em;"></span><span class="strut bottom" style="height:3.1304490000000005em;vertical-align:-1.302113em;"></span><span class="base displaystyle textstyle uncramped"><span class=""><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord">âˆ—</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord"><span class="text mord displaystyle textstyle uncramped"><span class="mord mathrm">a</span><span class="mord mathrm">r</span><span class="mord mathrm" style="margin-right:0.01389em;">g</span><span class="mord mathrm">m</span><span class="mord mathrm">a</span><span class="mord mathrm">x</span></span><span class="vlist"><span style="top:0.24444000000000002em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mop">exp</span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mop op-limits"><span class="vlist"><span style="top:1.1671129999999998em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.000005000000000143778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span><span class="op-symbol large-op mop">âˆ‘</span></span></span><span style="top:-1.2500050000000003em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mop op-limits"><span class="vlist"><span style="top:1.202113em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span><span style="top:-0.000005000000000032756em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span><span class="op-symbol large-op mop">âˆ‘</span></span></span><span style="top:-1.250005em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">K</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit">Î»</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">t</span><span class="mbin">âˆ’</span><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mpunct">,</span><span class=""><span class="mord mathbf">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size4">}</span></span></span></span></span></span></span></span>-------------------------<p><span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><mi mathvariant="bold">x</mi><mo>)</mo><mo>=</mo><msub><mo>âˆ‘</mo><mrow><mi mathvariant="bold">y</mi></mrow></msub><mo>âˆ</mo></mrow><annotation encoding="application/x-tex">p(\mathbf x)=\sum_{\mathbf y}\prod</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.186118em;vertical-align:-0.436118em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathbf">x</span><span class="mclose">)</span><span class="mrel">=</span><span class="mop"><span class="op-symbol small-op mop" style="top:-0.0000050000000000050004em;">âˆ‘</span><span class="vlist"><span style="top:0.30001em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="op-symbol small-op mop" style="top:-0.0000050000000000050004em;">âˆ</span></span></span></span></span></p></div></section></section></section><section id="tagging-evaluation"><h3 class="title"><a class="link-up" href="#"></a>Evaluation</h3><div><p>To compare the performance of CRFs, we also define a deterministic algorithm which serves as a baseline performance. The tagger uses many of the same features that the CRFs use to determine the labels for given tokens. (e.g. &#x27;if it looks like a known title, assign it to <code>title</code>&#x27;; &#x27;if it looks like a number and is congruent with previous numbers, assign it to <code>nr</code>&#x27;.)</p><p>For assessing the performance of our trained CRFs, we compare three conditions:</p><ol><li>The deterministic tagger as a baseline</li><li>One CRF trained on 100 documents that are randomly selected and manually annotated</li><li>One CRF trained on 100 documents that are randomly selected and manually annotated, but with all newline tokens omitted</li></ol><p>We include the newline condition, because including newlines could either positively or negatively affect performance. On the one hand, newlines carry semantic information information: the author thought it appropriate to demarcate something with whitespace. But on the other hand they might obscure information about the previous label. Consider a numbering, followed by a newline, followed by a section title. Our CRFs only consider one previous label, so the relationship between the numbering and the title might not be represented well. We see in <a href="#fig-results">Figure 3</a> that including newline tokens performs only slightly better than not including newlines.</p></div><section id="f-scores"><h4 class="title"><a class="link-up" href="#"></a>F-scores</h4><div><p>As a performance metric we use the common F<sub>1</sub> and F<sub>0.5</sub> scores. These are a composite number consisting of the precision and recall of a classifier, where</p><ul><li><span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtext><mi mathvariant="normal">p</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">n</mi></mtext><mo>=</mo><mfrac><mrow><mi mathvariant="normal">âˆ£</mi><mtext><mi mathvariant="normal">t</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">e</mi><mtext>Â </mtext><mi mathvariant="normal">p</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">s</mi></mtext><mi mathvariant="normal">âˆ£</mi></mrow><mrow><mi mathvariant="normal">âˆ£</mi><mtext><mi mathvariant="normal">t</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">e</mi><mtext>Â </mtext><mi mathvariant="normal">p</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">s</mi></mtext><mi mathvariant="normal">âˆ£</mi><mo>+</mo><mi mathvariant="normal">âˆ£</mi><mtext><mi mathvariant="normal">f</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">e</mi><mtext>Â </mtext><mi mathvariant="normal">p</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">s</mi></mtext><mi mathvariant="normal">âˆ£</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\text{precision}=\frac{|\text{true positives}|}{|\text{true positives}|+|\text{false positives}|}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.01em;"></span><span class="strut bottom" style="height:1.53em;vertical-align:-0.52em;"></span><span class="base textstyle uncramped"><span class="text mord textstyle uncramped"><span class="mord mathrm">p</span><span class="mord mathrm">r</span><span class="mord mathrm">e</span><span class="mord mathrm">c</span><span class="mord mathrm">i</span><span class="mord mathrm">s</span><span class="mord mathrm">i</span><span class="mord mathrm">o</span><span class="mord mathrm">n</span></span><span class="mrel">=</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.34500000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">âˆ£</span><span class="text mord scriptstyle cramped"><span class="mord mathrm">t</span><span class="mord mathrm">r</span><span class="mord mathrm">u</span><span class="mord mathrm">e</span><span class="mord mspace">Â </span><span class="mord mathrm">p</span><span class="mord mathrm">o</span><span class="mord mathrm">s</span><span class="mord mathrm">i</span><span class="mord mathrm">t</span><span class="mord mathrm">i</span><span class="mord mathrm" style="margin-right:0.01389em;">v</span><span class="mord mathrm">e</span><span class="mord mathrm">s</span></span><span class="mord mathrm">âˆ£</span><span class="mbin">+</span><span class="mord mathrm">âˆ£</span><span class="text mord scriptstyle cramped"><span class="mord mathrm" style="margin-right:0.07778em;">f</span><span class="mord mathrm">a</span><span class="mord mathrm">l</span><span class="mord mathrm">s</span><span class="mord mathrm">e</span><span class="mord mspace">Â </span><span class="mord mathrm">p</span><span class="mord mathrm">o</span><span class="mord mathrm">s</span><span class="mord mathrm">i</span><span class="mord mathrm">t</span><span class="mord mathrm">i</span><span class="mord mathrm" style="margin-right:0.01389em;">v</span><span class="mord mathrm">e</span><span class="mord mathrm">s</span></span><span class="mord mathrm">âˆ£</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.485em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">âˆ£</span><span class="text mord scriptstyle uncramped"><span class="mord mathrm">t</span><span class="mord mathrm">r</span><span class="mord mathrm">u</span><span class="mord mathrm">e</span><span class="mord mspace">Â </span><span class="mord mathrm">p</span><span class="mord mathrm">o</span><span class="mord mathrm">s</span><span class="mord mathrm">i</span><span class="mord mathrm">t</span><span class="mord mathrm">i</span><span class="mord mathrm" style="margin-right:0.01389em;">v</span><span class="mord mathrm">e</span><span class="mord mathrm">s</span></span><span class="mord mathrm">âˆ£</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span>, i.e. the fraction of true positives out of all positives</li><li><span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtext><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">l</mi></mtext><mo>=</mo><mfrac><mrow><mi mathvariant="normal">âˆ£</mi><mtext><mi mathvariant="normal">t</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">e</mi><mtext>Â </mtext><mi mathvariant="normal">p</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">s</mi></mtext><mi mathvariant="normal">âˆ£</mi></mrow><mrow><mi mathvariant="normal">âˆ£</mi><mtext><mi mathvariant="normal">t</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">u</mi><mi mathvariant="normal">e</mi><mtext>Â </mtext><mi mathvariant="normal">p</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">s</mi></mtext><mi mathvariant="normal">âˆ£</mi><mo>+</mo><mi mathvariant="normal">âˆ£</mi><mtext><mi mathvariant="normal">f</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">e</mi><mtext>Â </mtext><mi mathvariant="normal">n</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">v</mi><mi mathvariant="normal">e</mi></mtext><mi mathvariant="normal">âˆ£</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\text{recall}=\frac{|\text{true positives}|}{|\text{true positives}|+|\text{false negative}|}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.01em;"></span><span class="strut bottom" style="height:1.53em;vertical-align:-0.52em;"></span><span class="base textstyle uncramped"><span class="text mord textstyle uncramped"><span class="mord mathrm">r</span><span class="mord mathrm">e</span><span class="mord mathrm">c</span><span class="mord mathrm">a</span><span class="mord mathrm">l</span><span class="mord mathrm">l</span></span><span class="mrel">=</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.34500000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">âˆ£</span><span class="text mord scriptstyle cramped"><span class="mord mathrm">t</span><span class="mord mathrm">r</span><span class="mord mathrm">u</span><span class="mord mathrm">e</span><span class="mord mspace">Â </span><span class="mord mathrm">p</span><span class="mord mathrm">o</span><span class="mord mathrm">s</span><span class="mord mathrm">i</span><span class="mord mathrm">t</span><span class="mord mathrm">i</span><span class="mord mathrm" style="margin-right:0.01389em;">v</span><span class="mord mathrm">e</span><span class="mord mathrm">s</span></span><span class="mord mathrm">âˆ£</span><span class="mbin">+</span><span class="mord mathrm">âˆ£</span><span class="text mord scriptstyle cramped"><span class="mord mathrm" style="margin-right:0.07778em;">f</span><span class="mord mathrm">a</span><span class="mord mathrm">l</span><span class="mord mathrm">s</span><span class="mord mathrm">e</span><span class="mord mspace">Â </span><span class="mord mathrm">n</span><span class="mord mathrm">e</span><span class="mord mathrm" style="margin-right:0.01389em;">g</span><span class="mord mathrm">a</span><span class="mord mathrm">t</span><span class="mord mathrm">i</span><span class="mord mathrm" style="margin-right:0.01389em;">v</span><span class="mord mathrm">e</span></span><span class="mord mathrm">âˆ£</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.485em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">âˆ£</span><span class="text mord scriptstyle uncramped"><span class="mord mathrm">t</span><span class="mord mathrm">r</span><span class="mord mathrm">u</span><span class="mord mathrm">e</span><span class="mord mspace">Â </span><span class="mord mathrm">p</span><span class="mord mathrm">o</span><span class="mord mathrm">s</span><span class="mord mathrm">i</span><span class="mord mathrm">t</span><span class="mord mathrm">i</span><span class="mord mathrm" style="margin-right:0.01389em;">v</span><span class="mord mathrm">e</span><span class="mord mathrm">s</span></span><span class="mord mathrm">âˆ£</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span>, i.e. the fraction of true positives out of all relevant elements</li></ul><p>We define the general F<sub>Î²</sub>-measure as:</p><span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>F</mi><mi>Î²</mi></msub><mo>=</mo><mo>(</mo><mn>1</mn><mo>+</mo><msup><mi>Î²</mi><mn>2</mn></msup><mo>)</mo><mo>â‹…</mo><mfrac><mrow><mtext><mi mathvariant="normal">p</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">n</mi></mtext><mo>â‹…</mo><mtext><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">l</mi></mtext></mrow><mrow><mo>(</mo><msup><mi>Î²</mi><mn>2</mn></msup><mo>â‹…</mo><mtext><mi mathvariant="normal">p</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">n</mi></mtext><mo>)</mo><mo>+</mo><mtext><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">l</mi></mtext></mrow></mfrac></mrow><annotation encoding="application/x-tex">F_\beta = (1+\beta^2)\cdot\frac{\text{precision}\cdot\text{recall}}{(\beta^2\cdot\text{precision})+\text{recall}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.37144em;"></span><span class="strut bottom" style="height:2.30744em;vertical-align:-0.936em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">F</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.05278em;">Î²</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mopen">(</span><span class="mord mathrm">1</span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.05278em;">Î²</span><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span><span class="mbin">â‹…</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.05278em;">Î²</span><span class="vlist"><span style="top:-0.289em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mbin">â‹…</span><span class="text mord textstyle cramped"><span class="mord mathrm">p</span><span class="mord mathrm">r</span><span class="mord mathrm">e</span><span class="mord mathrm">c</span><span class="mord mathrm">i</span><span class="mord mathrm">s</span><span class="mord mathrm">i</span><span class="mord mathrm">o</span><span class="mord mathrm">n</span></span><span class="mclose">)</span><span class="mbin">+</span><span class="text mord textstyle cramped"><span class="mord mathrm">r</span><span class="mord mathrm">e</span><span class="mord mathrm">c</span><span class="mord mathrm">a</span><span class="mord mathrm">l</span><span class="mord mathrm">l</span></span></span></span></span><span style="top:-0.2300000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="text mord textstyle uncramped"><span class="mord mathrm">p</span><span class="mord mathrm">r</span><span class="mord mathrm">e</span><span class="mord mathrm">c</span><span class="mord mathrm">i</span><span class="mord mathrm">s</span><span class="mord mathrm">i</span><span class="mord mathrm">o</span><span class="mord mathrm">n</span></span><span class="mbin">â‹…</span><span class="text mord textstyle uncramped"><span class="mord mathrm">r</span><span class="mord mathrm">e</span><span class="mord mathrm">c</span><span class="mord mathrm">a</span><span class="mord mathrm">l</span><span class="mord mathrm">l</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span></span><p>Where <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Î²</mi><mo>âˆˆ</mo><mrow><mi mathvariant="double-struck">R</mi></mrow></mrow><annotation encoding="application/x-tex">\beta\in\mathbb{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05278em;">Î²</span><span class="mrel">âˆˆ</span><span class="mord textstyle uncramped"><span class="mord mathbb">R</span></span></span></span></span></span> is a number that represents the number of times we place the importance of the recall metric above that of precision. For <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Î²</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\beta = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05278em;">Î²</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span></span>, precision is equally as important as recall, and so <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>F</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">F_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">F</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span></span></span></span></span> describes the harmonic mean of precision and recall (<span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>F</mi><mn>1</mn></msub><mo>=</mo><mn>2</mn><mo>â‹…</mo><mfrac><mrow><mtext><mi mathvariant="normal">p</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">n</mi></mtext><mo>â‹…</mo><mtext><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">l</mi></mtext></mrow><mrow><mtext><mi mathvariant="normal">p</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">n</mi></mtext><mo>+</mo><mtext><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">l</mi><mi mathvariant="normal">l</mi></mtext></mrow></mfrac></mrow><annotation encoding="application/x-tex">F_1 = 2\cdot\frac{\text{precision}\cdot\text{recall}}{\text{precision}+\text{recall}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.9322159999999999em;"></span><span class="strut bottom" style="height:1.4133239999999998em;vertical-align:-0.481108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">F</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mrel">=</span><span class="mord mathrm">2</span><span class="mbin">â‹…</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="text mord scriptstyle cramped"><span class="mord mathrm">p</span><span class="mord mathrm">r</span><span class="mord mathrm">e</span><span class="mord mathrm">c</span><span class="mord mathrm">i</span><span class="mord mathrm">s</span><span class="mord mathrm">i</span><span class="mord mathrm">o</span><span class="mord mathrm">n</span></span><span class="mbin">+</span><span class="text mord scriptstyle cramped"><span class="mord mathrm">r</span><span class="mord mathrm">e</span><span class="mord mathrm">c</span><span class="mord mathrm">a</span><span class="mord mathrm">l</span><span class="mord mathrm">l</span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.44610799999999995em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="text mord scriptstyle uncramped"><span class="mord mathrm">p</span><span class="mord mathrm">r</span><span class="mord mathrm">e</span><span class="mord mathrm">c</span><span class="mord mathrm">i</span><span class="mord mathrm">s</span><span class="mord mathrm">i</span><span class="mord mathrm">o</span><span class="mord mathrm">n</span></span><span class="mbin">â‹…</span><span class="text mord scriptstyle uncramped"><span class="mord mathrm">r</span><span class="mord mathrm">e</span><span class="mord mathrm">c</span><span class="mord mathrm">a</span><span class="mord mathrm">l</span><span class="mord mathrm">l</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span>). For <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Î²</mi><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>5</mn></mrow><annotation encoding="application/x-tex">\beta = 0.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05278em;">Î²</span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">5</span></span></span></span></span>, precision is twice as important as recall.</p></div></section><section id="tagging-results"><h4 class="title"><a class="link-up" href="#"></a>Results</h4><div><p>For all tokens except for section titles, all models yield F-scores between 0.98 and 1.0. (See confusion matrix in <a href="#fig-confusion-matrix">Figure 4</a>. Section titles are harder to label, so in <a href="#fig-results">Figure 3</a>, we consider the F-score for these. We can see that the CRFs out-perform the baseline task mostly by increasing the recall, although the CRFs have slightly worse precision (0.91 for CRFs contra 0.96 for hand-written).</p><figure class="chart" id="fig-results"><h4 style="text-align:center;width:402px;margin:0;">F-scores for tagging section titles</h4><svg class="chart" width="400" height="300"><g transform="translate(50,72)"><g class="axis"><g class="x axis" transform="translate(0,198)"><g style="opacity:1;" class="tick" transform="translate(90,0)"><line y2="6" x2="0"></line><text style="text-anchor:middle;" dy=".71em" y="9" x="0">F1 scores</text></g><g style="opacity:1;" class="tick" transform="translate(240,0)"><line y2="6" x2="0"></line><text style="text-anchor:middle;" dy=".71em" y="9" x="0">F0.5 scores</text></g><path class="domain" d="M0,6V0H330V6"></path></g></g><g class="axis"><g class="y axis"><g style="opacity:1;" class="tick" transform="translate(0,198)"><line x2="-0.1" y2="0"></line><text style="text-anchor:end;" dy=".32em" x="-3.1" y="0">0.0</text></g><g style="opacity:1;" class="tick" transform="translate(0,178.20000000000002)"><line x2="-0.1" y2="0"></line><text style="text-anchor:end;" dy=".32em" x="-3.1" y="0">0.1</text></g><g style="opacity:1;" class="tick" transform="translate(0,158.4)"><line x2="-0.1" y2="0"></line><text style="text-anchor:end;" dy=".32em" x="-3.1" y="0">0.2</text></g><g style="opacity:1;" class="tick" transform="translate(0,138.6)"><line x2="-0.1" y2="0"></line><text style="text-anchor:end;" dy=".32em" x="-3.1" y="0">0.3</text></g><g style="opacity:1;" class="tick" transform="translate(0,118.8)"><line x2="-0.1" y2="0"></line><text style="text-anchor:end;" dy=".32em" x="-3.1" y="0">0.4</text></g><g style="opacity:1;" class="tick" transform="translate(0,99)"><line x2="-0.1" y2="0"></line><text style="text-anchor:end;" dy=".32em" x="-3.1" y="0">0.5</text></g><g style="opacity:1;" class="tick" transform="translate(0,79.2)"><line x2="-0.1" y2="0"></line><text style="text-anchor:end;" dy=".32em" x="-3.1" y="0">0.6</text></g><g style="opacity:1;" class="tick" transform="translate(0,59.400000000000006)"><line x2="-0.1" y2="0"></line><text style="text-anchor:end;" dy=".32em" x="-3.1" y="0">0.7</text></g><g style="opacity:1;" class="tick" transform="translate(0,39.599999999999994)"><line x2="-0.1" y2="0"></line><text style="text-anchor:end;" dy=".32em" x="-3.1" y="0">0.8</text></g><g style="opacity:1;" class="tick" transform="translate(0,19.799999999999997)"><line x2="-0.1" y2="0"></line><text style="text-anchor:end;" dy=".32em" x="-3.1" y="0">0.9</text></g><g style="opacity:1;" class="tick" transform="translate(0,0)"><line x2="-0.1" y2="0"></line><text style="text-anchor:end;" dy=".32em" x="-3.1" y="0">1.0</text></g><path class="domain" d="M-0.1,0H0V198H-0.1"></path><text style="text-anchor:end;" transform="rotate(-90)" y="6" dy=".71em"></text></g></g><g><g><line class="horizontalGrid" x1="20" x2="330" y1="198" y2="198" fill="none" stroke="lightgray" stroke-width="1px"></line><line class="horizontalGrid" x1="20" x2="330" y1="178.20000000000002" y2="178.20000000000002" fill="none" stroke="lightgray" stroke-width="1px"></line><line class="horizontalGrid" x1="20" x2="330" y1="158.4" y2="158.4" fill="none" stroke="lightgray" stroke-width="1px"></line><line class="horizontalGrid" x1="20" x2="330" y1="138.6" y2="138.6" fill="none" stroke="lightgray" stroke-width="1px"></line><line class="horizontalGrid" x1="20" x2="330" y1="118.8" y2="118.8" fill="none" stroke="lightgray" stroke-width="1px"></line><line class="horizontalGrid" x1="20" x2="330" y1="99" y2="99" fill="none" stroke="lightgray" stroke-width="1px"></line><line class="horizontalGrid" x1="20" x2="330" y1="79.2" y2="79.2" fill="none" stroke="lightgray" stroke-width="1px"></line><line class="horizontalGrid" x1="20" x2="330" y1="59.400000000000006" y2="59.400000000000006" fill="none" stroke="lightgray" stroke-width="1px"></line><line class="horizontalGrid" x1="20" x2="330" y1="39.599999999999994" y2="39.599999999999994" fill="none" stroke="lightgray" stroke-width="1px"></line><line class="horizontalGrid" x1="20" x2="330" y1="19.799999999999997" y2="19.799999999999997" fill="none" stroke="lightgray" stroke-width="1px"></line><line class="horizontalGrid" x1="20" x2="330" y1="0" y2="0" fill="none" stroke="lightgray" stroke-width="1px"></line></g></g><g><g class="f-score-group" transform="translate(30,0)"><rect class="bar series-1" x="0" y="32.56578947368421" fill="#AA0A0A" width="40" height="165.43421052631578" data-x="Deterministic tagger (baseline)" data-y="0.8355263157894737"><title>undefined, Deterministic tagger (baseline) (0.8355263157894737)</title></rect><rect class="bar series-1" x="40" y="17.36842105263159" fill="#1E405C" width="40" height="180.6315789473684" data-x="CRF trained on manually annotated (with newlines)" data-y="0.9122807017543859"><title>undefined, CRF trained on manually annotated (with newlines) (0.9122807017543859)</title></rect><rect class="bar series-1" x="80" y="17.510204081632672" fill="#2C70A9" width="40" height="180.48979591836732" data-x="CRF trained on manually annotated (no newlines)" data-y="0.91156462585034"><title>undefined, CRF trained on manually annotated (no newlines) (0.91156462585034)</title></rect></g><g class="f-score-group" transform="translate(180,0)"><rect class="bar series-1" x="0" y="19.152204836415375" fill="#AA0A0A" width="40" height="178.84779516358464" data-x="Deterministic tagger (baseline)" data-y="0.9032716927453769"><title>undefined, Deterministic tagger (baseline) (0.9032716927453769)</title></rect><rect class="bar series-1" x="40" y="17.36842105263161" fill="#1E405C" width="40" height="180.63157894736838" data-x="CRF trained on manually annotated (with newlines)" data-y="0.9122807017543858"><title>undefined, CRF trained on manually annotated (with newlines) (0.9122807017543858)</title></rect><rect class="bar series-1" x="80" y="17.825378346915016" fill="#2C70A9" width="40" height="180.17462165308498" data-x="CRF trained on manually annotated (no newlines)" data-y="0.9099728366317423"><title>undefined, CRF trained on manually annotated (no newlines) (0.9099728366317423)</title></rect></g></g></g><g width="312" class="legend"><g class="label series-1"><rect x="370" y="4" fill="#AA0A0A" width="20" height="12" class="series-1"></rect><text fill="#000" text-anchor="end" x="365" y="14">Deterministic tagger (baseline)</text></g><g class="label series-2"><rect x="370" y="20" fill="#1E405C" width="20" height="12" class="series-2"></rect><text fill="#000" text-anchor="end" x="365" y="30">CRF trained on manually annotated (with newlines)</text></g><g class="label series-3"><rect x="370" y="36" fill="#2C70A9" width="20" height="12" class="series-3"></rect><text fill="#000" text-anchor="end" x="365" y="46">CRF trained on manually annotated (no newlines)</text></g></g><a xlink:href="../js/tagger-results.json"><text style="text-decoration:underline;fill:#0000EE;" text-anchor="start" x="12" y="20">Data source</text></a></svg><figcaption><span class="figure-number">Fig 3.</span> F<sub>1</sub> scores and F<sub>0.5</sub> scores for different training conditions of Conditional Random Fields.</figcaption></figure><figure class="chart" id="fig-confusion-matrix"><table style="margin:0 0 80px 0;"><caption>Deterministic tagger (baseline)</caption><thead><tr><td></td><td></td><th style="text-align:center;font-weight:normal;" colspan="4">Predicted</th></tr><tr><td></td><td></td><th>NEWLINE</th><th>NR</th><th>SECTION_TITLE</th><th>TEXT_BLOCK</th></tr></thead><tbody><tr><th>NEWLINE</th><th style="font-weight:normal;" rowspan="4"><div class="minus90">Actual</div></th><td>3557</td><td>0</td><td>0</td><td>0</td></tr><tr><th>NR</th><td>0</td><td>1593</td><td>0</td><td>10</td></tr><tr><th>SECTION_TITLE</th><td>0</td><td>0</td><td>381</td><td>132</td></tr><tr><th>TEXT_BLOCK</th><td>0</td><td>0</td><td>18</td><td>5417</td></tr></tbody></table><table style="margin:0 0 80px 0;"><caption>CRF trained on manually annotated (with newlines)</caption><thead><tr><td></td><td></td><th style="text-align:center;font-weight:normal;" colspan="4">Predicted</th></tr><tr><td></td><td></td><th>NEWLINE</th><th>NR</th><th>SECTION_TITLE</th><th>TEXT_BLOCK</th></tr></thead><tbody><tr><th>NEWLINE</th><th style="font-weight:normal;" rowspan="4"><div class="minus90">Actual</div></th><td>3557</td><td>0</td><td>0</td><td>0</td></tr><tr><th>NR</th><td>0</td><td>1603</td><td>0</td><td>0</td></tr><tr><th>SECTION_TITLE</th><td>0</td><td>0</td><td>468</td><td>45</td></tr><tr><th>TEXT_BLOCK</th><td>0</td><td>0</td><td>45</td><td>5390</td></tr></tbody></table><table style="margin:0 0 80px 0;"><caption>CRF trained on manually annotated (no newlines)</caption><thead><tr><td></td><td></td><th style="text-align:center;font-weight:normal;" colspan="3">Predicted</th></tr><tr><td></td><td></td><th>NR</th><th>SECTION_TITLE</th><th>TEXT_BLOCK</th></tr></thead><tbody><tr><th>NR</th><th style="font-weight:normal;" rowspan="3"><div class="minus90">Actual</div></th><td>1603</td><td>0</td><td>0</td></tr><tr><th>SECTION_TITLE</th><td>0</td><td>469</td><td>44</td></tr><tr><th>TEXT_BLOCK</th><td>0</td><td>47</td><td>5388</td></tr></tbody></table><figcaption><span class="figure-number">Fig 4.</span>Confusion matrices for the three test conditions.</figcaption></figure><p>Neither the deterministic tagger nor the CRFs have been extensively optimized, so these are promising to improve upon. Taking a closer look at faulty labels, we observe that most errors are snippets of text that contain just a noun phrase, and it is easy to imagine how the CRF assigns such a text block as a title or vice versa. Furthermore, due to the sometimes very staccato paragraphs in case law, it can be hard even for humans to distinguish section titles and running text.</p></div></section></section></section></div><div><section class="chapter"><h2 class="title"><a class="link-up" href="#"></a>Inferring a Section Hierarchy</h2><section id="parse-tree-introduction"><h3 class="title"><a class="link-up" href="#"></a>Introduction</h3><div><p>After we have labeled our sequence of text elements, we wish to infer the position of these elements in a section hierarchy. We approach this problem as parsing a sequence of terminals with a Stochastic Context Free Grammar (SCFG) into a parse tree, which represents the document section hierarchy.</p><p>In this chapter, we introduce SCFGs and the Cockeâ€“Youngerâ€“Kasami algorithm (CYK), a deterministic algorithm for finding the best parse tree in quadratic space and time. We conclude with an evaluation of the results.</p></div></section><section id="parse-tree-methods"><h3 class="title"><a class="link-up" href="#"></a>Methods</h3><div><section id="scfg"><h4 class="title"><a class="link-up" href="#"></a>Stochastic Context Free Grammars</h4><div><p>Context Free Grammars (CFGs) are grammars where each rule is of the form</p><span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mo>â†’</mo><mi>Î±</mi></mrow><annotation encoding="application/x-tex">A \rightarrow \alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit">A</span><span class="mrel">â†’</span><span class="mord mathit" style="margin-right:0.0037em;">Î±</span></span></span></span></span></span><p>where <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">A</span></span></span></span></span> is a single non-terminal symbol and <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Î±</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.0037em;">Î±</span></span></span></span></span> is any string of terminals and non-terminals, including the empty string <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Ïµ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">Ïµ</span></span></span></span></span>.</p><p>A Probabilistic Context Free Grammar (PCFG) is then a Context Free Grammar in which each rule has a probability assigned to it, and every application of a rule multiplies its probability with the probabilities of all previously applied rules.</p><p>A lot of work has been done in parsing (subsets of) (P)CFGs in applications of natural language processing and parsing programming languages. More recently, PCFGs have been used for modeling RNA structures, such as in <a class="inline-citation" href="#sakakibara1994stochastic">Sakakibara et al. (1994, pp. 5112â€”5120)</a>.</p></div></section><section id="cyk"><h4 class="title"><a class="link-up" href="#"></a>CYK Algorithm</h4><div><p>The Cockeâ€“Youngerâ€“Kasami (CYK) algorithm is an algorithm for parsing Context Free Grammars that was separately discovered by <a class="inline-citation" href="#kasami1965efficient">Kasami (1965)</a>, <a class="inline-citation" href="#younger1967recognition">Younger (1967, pp. 189â€”208)</a> and <a class="inline-citation" href="#cocke1969programming">Cocke (1969)</a>. The algorithm has worst case complexity of <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Î˜</mi><mo>(</mo><msup><mi>n</mi><mn>3</mn></msup><mo>â‹…</mo><mrow><mo fence="true">âˆ£</mo><mi>G</mi><mo fence="true">âˆ£</mo></mrow><mo>)</mo></mrow><annotation encoding="application/x-tex">\Theta (n^3\cdot \left | G \right |)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">Î˜</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">3</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mbin">â‹…</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">âˆ£</span><span class="mord mathit">G</span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">âˆ£</span></span><span class="mclose">)</span></span></span></span></span>, where <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">n</span></span></span></span></span> is the length of the input string and <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">âˆ£</mo><mi>G</mi><mo fence="true">âˆ£</mo></mrow></mrow><annotation encoding="application/x-tex">\left | G \right |</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">âˆ£</span><span class="mord mathit">G</span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">âˆ£</span></span></span></span></span></span> is the size of the grammar.</p><p>The standard version of the CYK algorithm is defined for ordinary context free grammars that are given in Chomsky normal form (CNF), but is is easy to extend the algorithm to include support for unary rules as well, as we do in this section. Note that any CFG may be transformed into an equivalent grammar in Chomsky normal form, and this also holds for stochastic CFGs (<a class="inline-citation" href="#huang1971stochastic"> (1971, pp. 201â€”224)</a>). Also note that converting a grammar to CNF is not without cost: the increase in grammar size is <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">O</mi><mo>(</mo><msup><mrow><mo fence="true">âˆ£</mo><mi>G</mi><mo fence="true">âˆ£</mo></mrow><mn>2</mn></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">\mathrm O (\left | G \right |^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8151079999999999em;"></span><span class="strut bottom" style="height:1.065108em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">O</span><span class="mopen">(</span><span class="minner"><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">âˆ£</span><span class="mord mathit">G</span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">âˆ£</span></span><span class="vlist"><span style="top:-0.364em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span></span> for the best algorithm, but the increase is linear if we use a variation of the algorithm that works on grammars in binary normal form (2NF). (<a class="inline-citation" href="#lange2009cnf">Lange and LeiÃŸ (2009, pp. 2008â€”2010)</a>.)</p><p>The algorithm is a bottom-up parsing algorithm. The algorith considers every substring from length <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span></span></span></span></span> to <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">n</span></span></span></span></span>, and tries to assign a non-terminal label to the substring along with a score. For substrings of length <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span></span></span></span></span> (individual words), we use the terminal rules in the grammar. For substrings of length <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">l&gt;1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mrel">&gt;</span><span class="mord mathrm">1</span></span></span></span></span> (word sequences), we apply the production rules to every possible combination of two substrings of length <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">l-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mbin">âˆ’</span><span class="mord mathrm">1</span></span></span></span></span> (remember that CNF mandates that all production rules have 2 non-terminals). Every time we apply a rule, we multiply the probability attached to the rule and the probabilities of the constituent substrings.</p><p>This describes the basic version of CYK. In addition to this, we also allow unary rules in our grammar of the form <code>A â†’ B</code>, where <code>A</code> and <code>B</code> are nonterminals. Extension of the algorith is simple: at the end of every substring assignment, we apply unary rules, and add the result if the rule produces a non-terminal that does not exist with at least that score in the table. We repeat until the cell does not change anymore.</p><p>A visual example of the result table can be found in <a href="#fig-parsing-triangle">Figure 1</a>.</p><figure id="fig-parsing-triangle"><strong>Grammar</strong><pre style="display:inline-block;">S  â†’ NP VP  (90%)<br/>S  â†’ VP     (10%)<br/>VP â†’ V NP   (50%)<br/>VP â†’ V      (10%)<br/>NP â†’ NP NP  (10%)<br/>NP â†’ N      (70%)<br/><br/>N  â†’ fish   (20%)<br/>N  â†’ people (50%)<br/>N  â†’ tanks  (20%)<br/>V  â†’ people (10%)<br/>V  â†’ fish   (60%)<br/>V  â†’ tanks  (30%)</pre><div class="table-container"><table><tbody><tr><td><div class="cyk-cell-content"><ol><li><code>NÂ (20%)</code></li><li><code>VÂ (60%)</code></li><li><code><strong>NPÂ (14%)</strong></code></li><li><code>VPÂ (6%)</code></li><li><code>SÂ (0.6%)</code></li></ol><code class="word">fish</code></div></td><td><div class="cyk-cell-content"><ol><li><code><strong>NPÂ (0.49%)</strong></code></li><li><code>VPÂ (10.5%)</code></li><li><code>SÂ (1.05%)</code></li></ol></div></td><td><div class="cyk-cell-content"><ol><li><code>NPÂ (0.0069%)</code></li><li><code>VPÂ (0.147%)</code></li><li><code>SÂ (0.09%)</code></li></ol></div></td><td><div class="cyk-cell-content"><ol><li><code>VPÂ (0.002%)</code></li><li><code>NPÂ (0.00001%)</code></li><li><code><strong>SÂ (0.019%)</strong></code></li></ol></div></td></tr><tr><td></td><td><div class="cyk-cell-content"><ol><li><code>NÂ (50%)</code></li><li><code>VÂ (10%)</code></li><li><code><strong>NPÂ (35%)</strong></code></li><li><code>VPÂ (1%)</code></li><li><code>SÂ (0.1%)</code></li></ol><code class="word">people</code></div></td><td><div class="cyk-cell-content"><ol><li><code>NPÂ (0.49%)</code></li><li><code>VPÂ (0.7%)</code></li><li><code>SÂ (1.89%)</code></li></ol></div></td><td><div class="cyk-cell-content"><ol><li><code>NPÂ (0.007%)</code></li><li><code>VPÂ (0.010%)</code></li><li><code>SÂ (1.323%)</code></li></ol></div></td></tr><tr><td></td><td></td><td><div class="cyk-cell-content"><ol><li><code>NÂ (20%)</code></li><li><code><strong>VÂ (60%)</strong></code></li><li><code>NPÂ (14%)</code></li><li><code>VPÂ (6%)</code></li><li><code>SÂ (0.6%)</code></li></ol><code class="word">fish</code></div></td><td><div class="cyk-cell-content"><ol><li><code>NPÂ (0.196%)</code></li><li><code><strong>VPÂ (4.2%)</strong></code></li><li><code>SÂ (0.42%)</code></li></ol></div></td></tr><tr><td></td><td></td><td></td><td><div class="cyk-cell-content"><ol><li><code>NÂ (20%)</code></li><li><code>VÂ (30%)</code></li><li><code><strong>NPÂ (14%)</strong></code></li><li><code>VPÂ (3%)</code></li><li><code>SÂ (0.3%)</code></li></ol><code class="word">tanks</code></div></td></tr></tbody></table></div><figcaption><span class="figure-number">Fig 1.</span> An example parse chart for the sentence &quot;fish people fish tanks&quot;, with the constituents that make up the resulting parse marked in bold. The top of the triangle represents the substring <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span></span></span></span></span> to <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>4</mn></mrow><annotation encoding="application/x-tex">4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">4</span></span></span></span></span>, i.e. the entire sentence. We can derive <code>S</code> by combining the substring from <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span></span></span></span></span> to <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">2</span></span></span></span></span> (<code>fish people</code>) and the substring from <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>3</mn></mrow><annotation encoding="application/x-tex">3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">3</span></span></span></span></span> to <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>4</mn></mrow><annotation encoding="application/x-tex">4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">4</span></span></span></span></span> (<code>fish tanks</code>) using the rule <code>S â†’ NP VP</code>. The nodes that make up a parse tree to <code>S</code> are marked.</figcaption></figure><p>The implementation of this algorithm can be found on Github.</p></div></section></div><section id="scfg"><h4 class="title"><a class="link-up" href="#"></a>Stochastic Context Free Grammars</h4><div><p>Context Free Grammars (CFGs) are grammars where each rule is of the form</p><span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mo>â†’</mo><mi>Î±</mi></mrow><annotation encoding="application/x-tex">A \rightarrow \alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit">A</span><span class="mrel">â†’</span><span class="mord mathit" style="margin-right:0.0037em;">Î±</span></span></span></span></span></span><p>where <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">A</span></span></span></span></span> is a single non-terminal symbol and <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Î±</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.0037em;">Î±</span></span></span></span></span> is any string of terminals and non-terminals, including the empty string <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Ïµ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">Ïµ</span></span></span></span></span>.</p><p>A Probabilistic Context Free Grammar (PCFG) is then a Context Free Grammar in which each rule has a probability assigned to it, and every application of a rule multiplies its probability with the probabilities of all previously applied rules.</p><p>A lot of work has been done in parsing (subsets of) (P)CFGs in applications of natural language processing and parsing programming languages. More recently, PCFGs have been used for modeling RNA structures, such as in <a class="inline-citation" href="#sakakibara1994stochastic">Sakakibara et al. (1994, pp. 5112â€”5120)</a>.</p></div></section><section id="cyk"><h4 class="title"><a class="link-up" href="#"></a>CYK Algorithm</h4><div><p>The Cockeâ€“Youngerâ€“Kasami (CYK) algorithm is an algorithm for parsing Context Free Grammars that was separately discovered by <a class="inline-citation" href="#kasami1965efficient">Kasami (1965)</a>, <a class="inline-citation" href="#younger1967recognition">Younger (1967, pp. 189â€”208)</a> and <a class="inline-citation" href="#cocke1969programming">Cocke (1969)</a>. The algorithm has worst case complexity of <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Î˜</mi><mo>(</mo><msup><mi>n</mi><mn>3</mn></msup><mo>â‹…</mo><mrow><mo fence="true">âˆ£</mo><mi>G</mi><mo fence="true">âˆ£</mo></mrow><mo>)</mo></mrow><annotation encoding="application/x-tex">\Theta (n^3\cdot \left | G \right |)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">Î˜</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">3</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mbin">â‹…</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">âˆ£</span><span class="mord mathit">G</span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">âˆ£</span></span><span class="mclose">)</span></span></span></span></span>, where <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">n</span></span></span></span></span> is the length of the input string and <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">âˆ£</mo><mi>G</mi><mo fence="true">âˆ£</mo></mrow></mrow><annotation encoding="application/x-tex">\left | G \right |</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">âˆ£</span><span class="mord mathit">G</span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">âˆ£</span></span></span></span></span></span> is the size of the grammar.</p><p>The standard version of the CYK algorithm is defined for ordinary context free grammars that are given in Chomsky normal form (CNF), but is is easy to extend the algorithm to include support for unary rules as well, as we do in this section. Note that any CFG may be transformed into an equivalent grammar in Chomsky normal form, and this also holds for stochastic CFGs (<a class="inline-citation" href="#huang1971stochastic"> (1971, pp. 201â€”224)</a>). Also note that converting a grammar to CNF is not without cost: the increase in grammar size is <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">O</mi><mo>(</mo><msup><mrow><mo fence="true">âˆ£</mo><mi>G</mi><mo fence="true">âˆ£</mo></mrow><mn>2</mn></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">\mathrm O (\left | G \right |^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8151079999999999em;"></span><span class="strut bottom" style="height:1.065108em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">O</span><span class="mopen">(</span><span class="minner"><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">âˆ£</span><span class="mord mathit">G</span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">âˆ£</span></span><span class="vlist"><span style="top:-0.364em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">â€‹</span></span>â€‹</span></span></span><span class="mclose">)</span></span></span></span></span> for the best algorithm, but the increase is linear if we use a variation of the algorithm that works on grammars in binary normal form (2NF). (<a class="inline-citation" href="#lange2009cnf">Lange and LeiÃŸ (2009, pp. 2008â€”2010)</a>.)</p><p>The algorithm is a bottom-up parsing algorithm. The algorith considers every substring from length <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span></span></span></span></span> to <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">n</span></span></span></span></span>, and tries to assign a non-terminal label to the substring along with a score. For substrings of length <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span></span></span></span></span> (individual words), we use the terminal rules in the grammar. For substrings of length <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">l&gt;1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mrel">&gt;</span><span class="mord mathrm">1</span></span></span></span></span> (word sequences), we apply the production rules to every possible combination of two substrings of length <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">l-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mbin">âˆ’</span><span class="mord mathrm">1</span></span></span></span></span> (remember that CNF mandates that all production rules have 2 non-terminals). Every time we apply a rule, we multiply the probability attached to the rule and the probabilities of the constituent substrings.</p><p>This describes the basic version of CYK. In addition to this, we also allow unary rules in our grammar of the form <code>A â†’ B</code>, where <code>A</code> and <code>B</code> are nonterminals. Extension of the algorith is simple: at the end of every substring assignment, we apply unary rules, and add the result if the rule produces a non-terminal that does not exist with at least that score in the table. We repeat until the cell does not change anymore.</p><p>A visual example of the result table can be found in <a href="#fig-parsing-triangle">Figure 1</a>.</p><figure id="fig-parsing-triangle"><strong>Grammar</strong><pre style="display:inline-block;">S  â†’ NP VP  (90%)<br/>S  â†’ VP     (10%)<br/>VP â†’ V NP   (50%)<br/>VP â†’ V      (10%)<br/>NP â†’ NP NP  (10%)<br/>NP â†’ N      (70%)<br/><br/>N  â†’ fish   (20%)<br/>N  â†’ people (50%)<br/>N  â†’ tanks  (20%)<br/>V  â†’ people (10%)<br/>V  â†’ fish   (60%)<br/>V  â†’ tanks  (30%)</pre><div class="table-container"><table><tbody><tr><td><div class="cyk-cell-content"><ol><li><code>NÂ (20%)</code></li><li><code>VÂ (60%)</code></li><li><code><strong>NPÂ (14%)</strong></code></li><li><code>VPÂ (6%)</code></li><li><code>SÂ (0.6%)</code></li></ol><code class="word">fish</code></div></td><td><div class="cyk-cell-content"><ol><li><code><strong>NPÂ (0.49%)</strong></code></li><li><code>VPÂ (10.5%)</code></li><li><code>SÂ (1.05%)</code></li></ol></div></td><td><div class="cyk-cell-content"><ol><li><code>NPÂ (0.0069%)</code></li><li><code>VPÂ (0.147%)</code></li><li><code>SÂ (0.09%)</code></li></ol></div></td><td><div class="cyk-cell-content"><ol><li><code>VPÂ (0.002%)</code></li><li><code>NPÂ (0.00001%)</code></li><li><code><strong>SÂ (0.019%)</strong></code></li></ol></div></td></tr><tr><td></td><td><div class="cyk-cell-content"><ol><li><code>NÂ (50%)</code></li><li><code>VÂ (10%)</code></li><li><code><strong>NPÂ (35%)</strong></code></li><li><code>VPÂ (1%)</code></li><li><code>SÂ (0.1%)</code></li></ol><code class="word">people</code></div></td><td><div class="cyk-cell-content"><ol><li><code>NPÂ (0.49%)</code></li><li><code>VPÂ (0.7%)</code></li><li><code>SÂ (1.89%)</code></li></ol></div></td><td><div class="cyk-cell-content"><ol><li><code>NPÂ (0.007%)</code></li><li><code>VPÂ (0.010%)</code></li><li><code>SÂ (1.323%)</code></li></ol></div></td></tr><tr><td></td><td></td><td><div class="cyk-cell-content"><ol><li><code>NÂ (20%)</code></li><li><code><strong>VÂ (60%)</strong></code></li><li><code>NPÂ (14%)</code></li><li><code>VPÂ (6%)</code></li><li><code>SÂ (0.6%)</code></li></ol><code class="word">fish</code></div></td><td><div class="cyk-cell-content"><ol><li><code>NPÂ (0.196%)</code></li><li><code><strong>VPÂ (4.2%)</strong></code></li><li><code>SÂ (0.42%)</code></li></ol></div></td></tr><tr><td></td><td></td><td></td><td><div class="cyk-cell-content"><ol><li><code>NÂ (20%)</code></li><li><code>VÂ (30%)</code></li><li><code><strong>NPÂ (14%)</strong></code></li><li><code>VPÂ (3%)</code></li><li><code>SÂ (0.3%)</code></li></ol><code class="word">tanks</code></div></td></tr></tbody></table></div><figcaption><span class="figure-number">Fig 1.</span> An example parse chart for the sentence &quot;fish people fish tanks&quot;, with the constituents that make up the resulting parse marked in bold. The top of the triangle represents the substring <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span></span></span></span></span> to <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>4</mn></mrow><annotation encoding="application/x-tex">4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">4</span></span></span></span></span>, i.e. the entire sentence. We can derive <code>S</code> by combining the substring from <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span></span></span></span></span> to <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>2</mn></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">2</span></span></span></span></span> (<code>fish people</code>) and the substring from <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>3</mn></mrow><annotation encoding="application/x-tex">3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">3</span></span></span></span></span> to <span><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>4</mn></mrow><annotation encoding="application/x-tex">4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.64444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">4</span></span></span></span></span> (<code>fish tanks</code>) using the rule <code>S â†’ NP VP</code>. The nodes that make up a parse tree to <code>S</code> are marked.</figcaption></figure><p>The implementation of this algorithm can be found on Github.</p></div></section></section><section id="parse-tree-evaluation"><h3 class="title"><a class="link-up" href="#"></a>Evaluation</h3><div></div><section id="parseval"><h4 class="title"><a class="link-up" href="#"></a>PARSEVAL</h4><div><p>Evaluating performance on a parse tree is not as straightforward as it is for classification. Like in the previous chapter, we evaluate our grammar using an F-score, except notions of precision and recall are harder to define. For evaluating the parser, we use a metric known as PARSEVAL (due to <a class="inline-citation" href="#abney1991procedure">Abney et al. (1991, pp. 306â€”311)</a>) with labelled precision and labelled recall (as in <a class="inline-citation" href="#collins1997three">Collins (1997, pp. 16â€”23)</a>).</p><p>In this metric, precision and recall are defined as follows:</p><ul><li>Precision is the fraction of correct constituents out of the total number of constituents in the candidate parse</li><li>Recall is the fraction of correct constituents out of the total number of constituents in the gold standard</li></ul><p>Where &#x27;correct constituent&#x27; means that each non-terminal node has the same label and the same yield (where &#x27;yield&#x27; means: the ordered list of leaf nodes).</p></div></section><section id="parsing-results"><h4 class="title"><a class="link-up" href="#"></a>Results &amp; Discussion</h4><div><p>Over a set of 10 random documents, we report an average F<sub>1</sub>-score of 0.92 (precision 0.93; recall 092).</p><p>Delving deeper into problematic parses, we see that there are a number of recurring types of errors that our parsing grammar makes. Firstly, it often occurs that subsections are not preceded by a full numbering. For example, consider the following section sequence:</p><pre>1.<br/>2.<br/>3.1<br/>3.2<br/></pre><p>Our grammar assumes that section 3.1 is a subsection of section 2, since section 2 is the first preceding supersection to 3.1. However, this not the desired result. The desired result would be to wrap the 3.X subsections in a section that represents section 3, even though there is no explicit numbering for section 3. This could be achieved with an extension to the section grammar.</p><p>Another issue is that the grammar has difficulty in deciding whether non-numbered sections should be subsections or not. Indeed, this can be difficult to determine purely on typography. One possible method to resolve this is to incorporate some extra domain-specific knowledge on sections. For example, sections with titles like &#x27;OVERWEGINGEN&#x27; (considerations) and &#x27;CONCLUSIE&#x27; (conclusion) are almost never subsections.</p><p>A note also on runtime complexity: although the algorithm is polynomial, it is slow, even after optimizing the algorithm for resource re-use and parallellizing calculation of the table cells. Parsing the longest document in the corpus, which consists of more than a 1000 elements, took about 10 minutes on an Intel i7 quad-core CPU from 2010 running at 2.67GHz. These are not fundamental problems, however, and we now discuss some likely fruitful avenues for future work.</p></div></section></section></section></div></div><section id="bibliography"><h2>References</h2><ol id="reference-list"><li itemprop="citation" itemscope="" itemtype="http://schema.org/CreativeWork" id="bradley2010learning" class="ref"><span class="ref-author">Bradley, Joseph K and Guestrin, Carlos</span> (<time datetime="2010" class="ref-year">2010</time>). <cite><a><span itemprop="name">Learning tree conditional random fields</span></a></cite>. </li><li itemprop="citation" itemscope="" itemtype="http://schema.org/CreativeWork" id="zhu2013fast" class="ref"><span class="ref-author">Zhu, Muhua and Zhang, Yue and Chen, Wenliang and Zhang, Min and Zhu, Jingbo</span> (<time datetime="2013" class="ref-year">2013</time>). <cite><a><span itemprop="name">Fast and Accurate Shift-Reduce Constituent Parsing.</span></a></cite>. </li><li itemprop="citation" itemscope="" itemtype="http://schema.org/CreativeWork" id="hale2001probabilistic" class="ref"><span class="ref-author">Hale, John</span> (<time datetime="2001" class="ref-year">2001</time>). <cite><a><span itemprop="name">A probabilistic Earley parser as a psycholinguistic model</span></a></cite>. </li><li itemprop="citation" itemscope="" itemtype="http://schema.org/CreativeWork" id="collins1997three" class="ref"><span class="ref-author">Collins, Michael</span> (<time datetime="1997" class="ref-year">1997</time>). <cite><a><span itemprop="name">Three generative, lexicalised models for statistical parsing</span></a></cite>. </li><li itemprop="citation" itemscope="" itemtype="http://schema.org/CreativeWork" id="abney1991procedure" class="ref"><span class="ref-author">Abney, Steven and Flickenger, S and Gdaniec, Claudia and Grishman, C and Harrison, Philip and Hindle, Donald and Ingria, Robert and Jelinek, Frederick and Klavans, Judith and Liberman, Mark and others</span> (<time datetime="1991" class="ref-year">1991</time>). <cite><a><span itemprop="name">Procedure for quantitatively comparing the syntactic coverage of English grammars</span></a></cite>. </li><li itemprop="citation" itemscope="" itemtype="http://schema.org/CreativeWork" id="sakakibara1994stochastic" class="ref"><span class="ref-author">Sakakibara, Yasubumi and Brown, Michael and Hughey, Richard and Mian, I Saira and SjÃ¶lander, Kimmen and Underwood, Rebecca C and Haussler, David</span> (<time datetime="1994" class="ref-year">1994</time>). <cite><a><span itemprop="name">Stochastic context-free grammers for tRNA modeling</span></a></cite>. <span><span class="ref-journal">Nucleic acids research</span>.</span></li><li itemprop="citation" itemscope="" itemtype="http://schema.org/CreativeWork" id="jordan2002discriminative" class="ref"><span class="ref-author">Ng, Andrew and Jordan, Michael</span> (<time datetime="2002" class="ref-year">2002</time>). <cite><a><span itemprop="name">On discriminative vs. generative classifiers: A comparison of logistic regression and naive bayes</span></a></cite>. <span><span class="ref-journal">Advances in neural information processing systems</span>.</span></li><li itemprop="citation" itemscope="" itemtype="http://schema.org/CreativeWork" id="younger1967recognition" class="ref"><span class="ref-author">Younger, Daniel</span> (<time datetime="1967" class="ref-year">1967</time>). <cite><a><span itemprop="name">Recognition and parsing of context-free languages in time nÂ³</span></a></cite>. <span><span class="ref-journal">Information and control</span>.</span></li><li itemprop="citation" itemscope="" itemtype="http://schema.org/CreativeWork" id="kasami1965efficient" class="ref"><span class="ref-author">Kasami, Tadao</span> (<time datetime="1965" class="ref-year">1965</time>). <cite><a><span itemprop="name">AN EFFICIENT RECOGNITION AND SYNTAX ANALYSIS ALGORITHM FOR CONTEXT-FREE LANGUAGES</span></a></cite>. </li><li itemprop="citation" itemscope="" itemtype="http://schema.org/CreativeWork" id="sipser2006introduction" class="ref"><span class="ref-author">Sipser, Michael</span> (<time datetime="2006" class="ref-year">2006</time>). <cite><a><span itemprop="name">Introduction to the Theory of Computation</span></a></cite>. </li><li itemprop="citation" itemscope="" itemtype="http://schema.org/CreativeWork" id="huang1971stochastic" class="ref"><span class="ref-author">undefined</span> (<time datetime="1971" class="ref-year">1971</time>). <cite><a><span itemprop="name">On stochastic context-free languages</span></a></cite>. <span><span class="ref-journal">Information Sciences</span>.</span></li><li itemprop="citation" itemscope="" itemtype="http://schema.org/CreativeWork" id="lange2009cnf" class="ref"><span class="ref-author">Lange, Martin and LeiÃŸ, Hans</span> (<time datetime="2009" class="ref-year">2009</time>). <cite><a><span itemprop="name">To CNF or not to CNF? An efficient yet presentable version of the CYK algorithm</span></a></cite>. <span><span class="ref-journal">Informatica Didactica</span>.</span></li><li itemprop="citation" itemscope="" itemtype="http://schema.org/CreativeWork" id="cocke1969programming" class="ref"><span class="ref-author">Cocke, John</span> (<time datetime="1969" class="ref-year">1969</time>). <cite><a><span itemprop="name">Programming languages and their compilers: Preliminary notes</span></a></cite>. </li><li itemprop="citation" itemscope="" itemtype="http://schema.org/CreativeWork" id="vanopijnen2014" class="ref"><span class="ref-author">van Opijnen, Marc</span> (<time datetime="2014" class="ref-year">2014</time>). <cite><a href="http://dare.uva.nl/record/1/408882"><span itemprop="name">Op en in het web: Hoe de toegankelijkheid van rechterlijke uitspraken kan worden verbeterd</span></a></cite>. </li><li itemprop="citation" itemscope="" itemtype="http://schema.org/CreativeWork" id="trompper2014" class="ref"><span class="ref-author">Trompper</span> (<time datetime="2014" class="ref-year">2014</time>). <cite><a href="http://leibniz-internship-report.herokuapp.com/eu-legal-data-survey/nl#rechtspraak.nl"><span itemprop="name">NL open legal data survey: Rechtspraak.nl</span></a></cite>. </li><li itemprop="citation" itemscope="" itemtype="http://schema.org/CreativeWork" id="mccallum2000maximum" class="ref"><span class="ref-author">McCallum, Andrew and Freitag, Dayne and Pereira, Fernando</span> (<time datetime="2000" class="ref-year">2000</time>). <cite><a href="http://cseweb.ucsd.edu/~elkan/254spring02/gidofalvi.pdf"><span itemprop="name">Maximum Entropy Markov Models for Information Extraction and Segmentation</span></a></cite>. </li><li itemprop="citation" itemscope="" itemtype="http://schema.org/CreativeWork" id="mallet" class="ref"><span class="ref-author">McCallum, Andrew Kachites</span> (<time datetime="2002" class="ref-year">2002</time>). <cite><a href="http://mallet.cs.umass.edu"><span itemprop="name">MALLET: A Machine Learning for Language Toolkit</span></a></cite>. </li><li itemprop="citation" itemscope="" itemtype="http://schema.org/CreativeWork" id="sutton2004conditional" class="ref"><span class="ref-author">Sutton, Charles and McCallum, Andrew</span> (<time datetime="2004" class="ref-year">2004</time>). <cite><a><span itemprop="name">Conditional probabilistic context-free grammars</span></a></cite>. </li><li itemprop="citation" itemscope="" itemtype="http://schema.org/CreativeWork" id="sutton2006introduction" class="ref"><span class="ref-author">Sutton, Charles and McCallum, Andrew</span> (<time datetime="2006" class="ref-year">2006</time>). <cite><a><span itemprop="name">An introduction to conditional random fields for relational learning</span></a></cite>. <span><span class="ref-journal">Introduction to statistical relational learning</span>.</span></li><li itemprop="citation" itemscope="" itemtype="http://schema.org/CreativeWork" id="finkel2004exploiting" class="ref"><span class="ref-author">Finkel, Jenny and Dingare, Shipra and Nguyen, Huy and Nissim, Malvina and Manning, Christopher and Sinclair, Gail</span> (<time datetime="2004" class="ref-year">2004</time>). <cite><a><span itemprop="name">Exploiting context for biomedical entity recognition: from syntax to the web</span></a></cite>. <span><span class="ref-journal">Proceedings of the International Joint Workshop on Natural Language Processing in Biomedicine and its Applications</span>.</span></li><li itemprop="citation" itemscope="" itemtype="http://schema.org/CreativeWork" id="klinger2009feature" class="ref"><span class="ref-author">Klinger, Roman and Friedrich, Christoph</span> (<time datetime="2009" class="ref-year">2009</time>). <cite><a><span itemprop="name">Feature Subset Selection in Conditional Random Fields for Named Entity Recognition</span></a></cite>. <span><span class="ref-journal">RANLP</span>.</span></li><li itemprop="citation" itemscope="" itemtype="http://schema.org/CreativeWork" id="krishnan2006effective" class="ref"><span class="ref-author">Krishnan, Vijay and Manning, Christopher D</span> (<time datetime="2006" class="ref-year">2006</time>). <cite><a><span itemprop="name">An effective two-stage model for exploiting non-local dependencies in named entity recognition</span></a></cite>. <span><span class="ref-journal">Proceedings of the 21st International Conference on Computational Linguistics and the 44th annual meeting of the Association for Computational Linguistics</span>.</span></li></ol></section><script id="initial-props" type="application/json">{"path":"/full/","assets":{"css":"bundle.js","main":"bundle.js"},"title":"Automatically Assigning A Section Hierarchy For Dutch Case Law","routes":["/","/introduction/","/importing-and-tokenizing/","/tagging/","/document-structure/","/conclusion/","/full/"]}</script></body></html>